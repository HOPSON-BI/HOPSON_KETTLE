<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>DATA_BASICS_Last</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2018&#x2f;03&#x2f;21 15&#x3a;49&#x3a;55.371</created_date>
  <modified_user>-</modified_user>
  <modified_date>2018&#x2f;03&#x2f;21 15&#x3a;49&#x3a;55.371</modified_date>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>BI</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>&#x6267;&#x884c;SQL&#x811a;&#x672c;</from><to>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x5165; 2</to><enabled>Y</enabled> </hop>
  <hop> <from>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x5165; 2</from><to>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x51fa;</to><enabled>Y</enabled> </hop>
  <hop> <from>&#x6267;&#x884c;SQL&#x811a;&#x672c; 2</from><to>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x5165;</to><enabled>Y</enabled> </hop>
  <hop> <from>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x5165;</from><to>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x51fa;</to><enabled>Y</enabled> </hop>
  </order>
  <step>
    <name>&#x6267;&#x884c;SQL&#x811a;&#x672c;</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>BI</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>DELETE FROM YW_YY_CAPITAL_ANALYST&#xd;&#xa;WHERE yearmonth&#x3e;&#x27;2016-12&#x27; &#xd;&#xa;AND project_code IN&#x28;&#xd;&#xa;SELECT distinct&#x28;a.project_code&#x29; as project_code&#xd;&#xa;FROM dbo.&#x5b;YW_HS_NC_BI_PROJECT_MAP&#x5d; a&#xd;&#xa;LEFT JOIN YW_HS_PROJECT_BASEINFO b ON a.project_code&#x3d;b.project_code &#xd;&#xa;WHERE b.business IN&#x28;&#x27;&#x5546;&#x573a;&#x27;,&#x27;&#x5199;&#x5b57;&#x697c;&#x27;,&#x27;&#x4ea7;&#x4e1a;&#x56ed;&#x27;&#x29;&#xd;&#xa;AND len&#x28;a.project_code&#x29; &#x3e;0&#xd;&#xa;&#x29;&#xd;&#xa;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>233</xloc>
      <yloc>202</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x6267;&#x884c;SQL&#x811a;&#x672c; 2</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>BI</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>DELETE FROM YW_YY_CAPITAL_ANALYST&#xd;&#xa;WHERE yearmonth&#x3e;&#x27;2016-12&#x27; &#xd;&#xa;AND project_code IN&#x28;&#xd;&#xa;SELECT distinct&#x28;a.project_code&#x29; FROM dbo.&#x5b;YW_HS_EAS_BI_PROJECT_MAP&#x5d; a&#xd;&#xa;LEFT JOIN YW_HS_PROJECT_BASEINFO b ON a.project_code&#x3d;b.project_code &#xd;&#xa;WHERE b.business IN&#x28;&#x27;&#x5546;&#x573a;&#x27;,&#x27;&#x5199;&#x5b57;&#x697c;&#x27;,&#x27;&#x4ea7;&#x4e1a;&#x56ed;&#x27;&#x29;&#xd;&#xa;AND len&#x28;a.project_code&#x29; &#x3e;0&#xd;&#xa;AND a.project_code NOT IN&#x28;&#x27;CD_A4_XZL&#x27;,&#x27;SH_HSH_QPMGTD&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT distinct project_code FROM dbo.&#x5b;YW_HS_EAS_BI_PROJECT_MAP&#x5d; WHERE  project_code IN&#x28;&#x27;TJ_GJDS&#x27;,&#x27;SH_HSH_WJCZHT&#x27;,&#x27;BJ_HSH_SDDJZHT&#x27;&#x29;&#xd;&#xa;&#x29;&#xd;&#xa;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>233</xloc>
      <yloc>78</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x5165;</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>BI</connection>
    <sql>WITH  XMJB AS&#x28;&#xd;&#xa;SELECT distinct&#x28;a.project_code&#x29;,b.project_name FROM dbo.&#x5b;YW_HS_EAS_BI_PROJECT_MAP&#x5d; a&#xd;&#xa;LEFT JOIN YW_HS_PROJECT_BASEINFO b ON a.project_code&#x3d;b.project_code &#xd;&#xa;WHERE b.business IN&#x28;&#x27;&#x5546;&#x573a;&#x27;,&#x27;&#x5199;&#x5b57;&#x697c;&#x27;,&#x27;&#x4ea7;&#x4e1a;&#x56ed;&#x27;,&#x27;&#x7efc;&#x5408;&#x4f53;&#x27;&#x29;&#xd;&#xa;AND len&#x28;a.project_code&#x29; &#x3e;0&#xd;&#xa;AND a.project_code NOT IN&#x28;&#x27;CD_A4_XZL&#x27;,&#x27;SH_HSH_QPMGTD&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT distinct project_code,project_name FROM dbo.&#x5b;YW_HS_EAS_BI_PROJECT_MAP&#x5d; WHERE  project_code IN&#x28;&#x27;TJ_GJDS&#x27;&#x29;&#xd;&#xa;&#x29;,--1.&#x9879;&#x76ee;&#x57fa;&#x672c;&#x4fe1;&#x606f;&#xd;&#xa;XMJB_SUBJECT AS &#x28;&#xd;&#xa;SELECT  &#xd;&#xa;a.project_code,&#xd;&#xa;a.project_name,&#xd;&#xa;b.subject_code,&#xd;&#xa;b.subject_name,&#xd;&#xa;b.kj_code,&#xd;&#xa;b.fx,&#xd;&#xa;b.assistprojectname&#xd;&#xa;FROM XMJB a&#xd;&#xa;LEFT JOIN YW_BI_EAS_SUBJECT_MAP b&#xd;&#xa;on 1&#x3d;1&#xd;&#xa;WHERE source&#x3d;&#x27;EAS&#x27;&#xd;&#xa;&#x29;,&#xd;&#xa;--2&#x6570;&#x636e;--&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x8868;&#xd;&#xa;km as &#x28;&#xd;&#xa;	select &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		 a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		&#x27;1&#x27; as assistprojectname,&#xd;&#xa;		CASE WHEN LEFT&#x28;a.subject_code,1&#x29;&#x3d;&#x27;1&#x27; THEN sum&#x28;a.period_J&#x29;-sum&#x28;a.period_D&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,1&#x29;&#x3d;&#x27;2&#x27; THEN sum&#x28;a.period_D&#x29;-sum&#x28;a.period_J&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,1&#x29;&#x3d;&#x27;4&#x27; THEN sum&#x28;a.period_D&#x29;-sum&#x28;a.period_J&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,1&#x29;&#x3d;&#x27;5&#x27; THEN sum&#x28;a.period_J&#x29;-SUM&#x28;a.period_D&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;60&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;61&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;62&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;63&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;64&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;65&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;66&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;67&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,2&#x29;&#x3d;&#x27;68&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.01&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.02&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.03&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.04&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.05&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.06&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.07&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.08&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.09&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.10&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.11&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.12&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.13&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;a.subject_code,7&#x29;&#x3d;&#x27;6901.14&#x27; THEN sum&#x28;a.period_FS&#x29; &#xd;&#xa;			 ELSE NULL END AS period --&#x671f;&#x672b;&#x4f59;&#x989d;&#xd;&#xa;	from YW_YY_EAS_ACCOUNTBALANCE a --&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x8868;&#xd;&#xa;	GROUP BY &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		a.subject_code&#xd;&#xa;&#x29;,&#xd;&#xa;km_data as &#x28;&#xd;&#xa;	SELECT &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		a.assistprojectname,&#xd;&#xa;		SUM&#x28;b.period&#x29; as end_balance&#xd;&#xa;	FROM km a &#xd;&#xa;	LEFT JOIN km b&#xd;&#xa;	ON a.project_code &#x3d;b.project_code&#xd;&#xa;		AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;		AND a.year&#x3d;b.year&#xd;&#xa;		AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;	GROUP BY &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		a.assistprojectname&#xd;&#xa;&#x29;,&#xd;&#xa;--2&#x6570;&#x636e;_&#x8f85;&#x52a9;&#x8d26;&#xd;&#xa;fzz AS &#x28;&#xd;&#xa;	select &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		 year,&#xd;&#xa;		 month,&#xd;&#xa;		a.assistprojectname,  --&#x8f85;&#x52a9;&#x6838;&#x7b97;&#x7684;&#x540d;&#x79f0;&#xd;&#xa;		CASE WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;1&#x27; THEN sum&#x28;a.period_J&#x29;-sum&#x28;a.period_D&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;2&#x27; THEN sum&#x28;a.period_D&#x29;-sum&#x28;a.period_J&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;4&#x27; THEN sum&#x28;a.period_D&#x29;-sum&#x28;a.period_J&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;5&#x27; THEN sum&#x28;a.period_J&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;60&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;61&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;62&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;63&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;64&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;65&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;66&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;67&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;68&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.01&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.02&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.03&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.04&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.05&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.06&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.07&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.08&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.09&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.10&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.11&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.12&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.13&#x27; THEN sum&#x28;a.period_FS&#x29;&#xd;&#xa;			 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;6901.14&#x27; THEN sum&#x28;a.period_FS&#x29; &#xd;&#xa;			 ELSE NULL END AS period --&#x671f;&#x672b;&#x4f59;&#x989d;&#xd;&#xa;	from YW_YY_EAS_ASSISTBALANCE a --&#x8f85;&#x52a9;&#x8d26;&#x8868;&#xd;&#xa;	WHERE a.assistprojectname&#x3d;&#x27;&#x9884;&#x4ed8;&#x6b3e;&#x27;&#xd;&#xa;	GROUP BY&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.assistprojectname  --&#x8f85;&#x52a9;&#x6838;&#x7b97;&#x7684;&#x540d;&#x79f0;&#xd;&#xa;&#x29;,&#xd;&#xa;fzz_data as &#x28;&#xd;&#xa;	SELECT &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		a.assistprojectname,&#xd;&#xa;		SUM&#x28;b.period&#x29; as end_balance&#xd;&#xa;	FROM fzz a &#xd;&#xa;	LEFT JOIN fzz b&#xd;&#xa;	ON a.project_code &#x3d;b.project_code&#xd;&#xa;		AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;		AND a.year&#x3d;b.year&#xd;&#xa;		AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;	GROUP BY &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		a.assistprojectname&#xd;&#xa;&#x29;,&#xd;&#xa;--&#x6570;&#x636e;---ebitda&#xd;&#xa; ebitda as &#x28;&#xd;&#xa;	select&#xd;&#xa;		a.project_code,&#xd;&#xa;		cast&#x28;&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;		cast&#x28;&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;		CASE WHEN a.subject_code&#x3d;&#x27;JYSR.01&#x27; THEN &#x27;SR&#x27; ELSE &#x27;ZC&#x27; END AS subject_code,&#xd;&#xa;		SUM&#x28;isnull&#x28;a.actual,0&#x29;&#x2a;10000&#x29; as actual,&#xd;&#xa;		&#x27;1&#x27; as assistprojectname&#xd;&#xa;	from YW_YY_BENEFIT_ANALYST a&#xd;&#xa;	where  a.year&#x3e;&#x27;2016&#x27;&#xd;&#xa;		AND a.subject_code IN &#x28;&#x27;JYSR.01&#x27;,&#x27;JYZC.01&#x27;&#x29;&#xd;&#xa;	GROUP BY  a.project_code,year,month,a.subject_code&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;EBITDA_SJdyue as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,&#xd;&#xa;  &#x27;LR1010&#x27; as subject_code,&#xd;&#xa;	year,&#xd;&#xa;	month,&#xd;&#xa;	&#x27;1&#x27; as assistprojectname,&#xd;&#xa;	SR-ZC AS end_balance&#xd;&#xa;FROM ebitda&#xd;&#xa;PIVOT&#xd;&#xa;&#x28;&#xd;&#xa;    SUM&#x28;actual&#x29; for subject_code in&#x28;SR,ZC&#x29;&#xd;&#xa;&#x29;TBL&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;ebitda_data AS &#x28;&#xd;&#xa;	SELECT &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month,&#xd;&#xa;		SUM&#x28;b.actual&#x29; as end_balance&#xd;&#xa;	FROM ebitda a&#xd;&#xa;	INNER JOIN ebitda b&#xd;&#xa;	ON a.project_code&#x3d;b.project_code&#xd;&#xa;	AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;	--AND CONVERT&#x28;VARCHAR&#x28;10&#x29;,CAST&#x28;a.year as VARCHAR&#x28;4&#x29;&#x29;&#x2b;&#x27;-&#x27;&#x2b;RIGHT&#x28;&#x27;0&#x27;&#x2b;CAST&#x28;a.month as VARCHAR&#x28;2&#x29;&#x29;,2&#x29;&#x2b;&#x27;-01&#x27;&#x29;&#x3e;&#x3d;CONVERT&#x28;VARCHAR&#x28;10&#x29;,CAST&#x28;b.year as VARCHAR&#x28;4&#x29;&#x29;&#x2b;&#x27;-&#x27;&#x2b;RIGHT&#x28;&#x27;0&#x27;&#x2b;CAST&#x28;b.month as VARCHAR&#x28;2&#x29;&#x29;,2&#x29;&#x2b;&#x27;-01&#x27;&#x29;&#xd;&#xa;	AND a.year&#x3d;b.year&#xd;&#xa;	AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;	GROUP BY &#xd;&#xa;		a.project_code,&#xd;&#xa;		a.subject_code,&#xd;&#xa;		a.year,&#xd;&#xa;		a.month&#xd;&#xa;&#x29;,&#xd;&#xa;EBITDA_SJ AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,&#xd;&#xa;  &#x27;LR1010&#x27; as subject_code,&#xd;&#xa;	year,&#xd;&#xa;	month,&#xd;&#xa;	&#x27;1&#x27; as assistprojectname,&#xd;&#xa;	SR-ZC AS end_balance&#xd;&#xa;FROM ebitda_data&#xd;&#xa;PIVOT&#xd;&#xa;&#x28;&#xd;&#xa;    SUM&#x28;end_balance&#x29; for subject_code in&#x28;SR,ZC&#x29;&#xd;&#xa;&#x29;TBL&#xd;&#xa;&#x29;,&#xd;&#xa;--&#x6570;&#x636e;---&#x5dee;&#x5f02;&#xd;&#xa;&#xd;&#xa;DIFFERENCE_CONTRAST as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;cast&#x28;&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;cast&#x28;&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;isnull&#x28;business_actual,0&#x29; as business_actual,&#xd;&#xa;isnull&#x28;Finance_actual,0&#x29; as Finance_actual&#xd;&#xa;FROM YW_YY_PROFIT_DIFFERENCE_CONTRAST &#xd;&#xa;WHERE subject_code&#x3d;&#x27;SR1010&#x27;&#xd;&#xa;AND &#x5b;year&#x5d;&#x3e;&#x27;2016&#x27;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;cast&#x28;&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;cast&#x28;&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;&#x27;ZC1020&#x27; as subject_code,&#xd;&#xa;&#x27;&#x7ecf;&#x8425;&#x652f;&#x51fa;&#x5408;&#x8ba1;&#x27; as subject_name,&#xd;&#xa;isnull&#x28;business_actual,0&#x29; as business_actual,&#xd;&#xa;isnull&#x28;Finance_actual,0&#x29; as Finance_actual&#xd;&#xa;FROM YW_YY_PROFIT_DIFFERENCE_CONTRAST &#xd;&#xa;WHERE subject_code &#x3d;&#x27;SR1010&#x27;&#xd;&#xa;AND &#x5b;year&#x5d;&#x3e;&#x27;2016&#x27;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;SELECT &#xd;&#xa;a.project_code,&#xd;&#xa;cast&#x28;a.year as int&#x29; as year,&#xd;&#xa;cast&#x28;a.month as int&#x29; as month,&#xd;&#xa;&#x27;ZC1020&#x27; as subject_code,&#xd;&#xa;&#x27;&#x7ecf;&#x8425;&#x652f;&#x51fa;&#x5408;&#x8ba1;&#x27; as subject_name,&#xd;&#xa;isnull&#x28;b.end_balance,0&#x29;&#x2a;-1 as business_actual,&#xd;&#xa;isnull&#x28;a.Finance_actual,0&#x29;&#x2a;-1 as Finance_actual&#xd;&#xa;FROM &#x28;SELECT&#x2a; FROM YW_YY_PROFIT_DIFFERENCE_CONTRAST WHERE subject_code &#x3d;&#x27;LR1030&#x27;&#xd;&#xa;AND &#x5b;year&#x5d;&#x3e;&#x27;2016&#x27;&#x29;a &#xd;&#xa;LEFT JOIN EBITDA_SJdyue b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;cy as &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;cast&#x28;&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;cast&#x28;&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;sum&#x28;isnull&#x28;business_actual,0&#x29;&#x29;&#x2a;10000-sum&#x28;isnull&#x28;Finance_actual,0&#x29;&#x29;&#x2a;10000 as cy&#xd;&#xa;FROM YW_YY_PROFIT_DIFFERENCE_CONTRAST &#xd;&#xa;WHERE subject_code in&#x28;&#x27;SR1010&#x27;,&#x27;ZC1020&#x27;&#x29;&#xd;&#xa;AND &#x5b;year&#x5d;&#x3e;&#x27;2016&#x27;&#xd;&#xa;GROUP BY project_code ,year,month,subject_code,subject_name&#xd;&#xa;&#x29;,&#xd;&#xa;cy_data as &#x28;&#xd;&#xa;SELECT &#xd;&#xa;a.project_code,&#xd;&#xa;a.subject_code,&#xd;&#xa;a.&#x5b;year&#x5d;,&#xd;&#xa;a.&#x5b;month&#x5d;,&#xd;&#xa;&#x27;1&#x27; as assistprojectname,&#xd;&#xa;SUM&#x28;b.cy&#x29; as end_balance&#xd;&#xa;FROM cy a &#xd;&#xa;INNER JOIN cy b&#xd;&#xa;on a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;and a.&#x5b;year&#x5d;&#x3d;b.&#x5b;year&#x5d;&#xd;&#xa;and a.&#x5b;month&#x5d;&#x3e;&#x3d;b.&#x5b;month&#x5d;&#xd;&#xa;GROUP BY a.project_code,&#xd;&#xa;a.subject_code,&#xd;&#xa;a.&#x5b;year&#x5d;,&#xd;&#xa;a.&#x5b;month&#x5d;&#xd;&#xa;&#x29;,&#xd;&#xa;--s&#x6570;&#x636e;&#x2014;&#x2014;&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1; &#x8d44;&#x91d1;&#x8d21;&#x732e;&#xd;&#xa; --&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#xd;&#xa; end_1 as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;  a.project_code,&#xd;&#xa;  a.subject_code,&#xd;&#xa;	cast&#x28;a.&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;	cast&#x28;a.&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;	&#x27;1&#x27; as assistprojectname,&#xd;&#xa;  sum&#x28;ISNULL&#x28;a.period_D,0&#x29;&#x29;-sum&#x28;ISNULL&#x28;a.period_J,0&#x29;&#x29; AS end1&#xd;&#xa;from YW_YY_EAS_ACCOUNTBALANCE a --&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x8868;&#xd;&#xa;where&#xd;&#xa; a.subject_code&#x3d;&#x27;2241.01&#x27;&#xd;&#xa; AND a.year&#x3e;&#x27;2016&#x27;&#xd;&#xa;GROUP BY &#xd;&#xa;	a.project_code,&#xd;&#xa;	a.year ,&#xd;&#xa;	a.month,&#xd;&#xa;	a.subject_code&#xd;&#xa;&#x29;,&#xd;&#xa;--&#xd;&#xa;end_2 AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;  a.project_code,&#xd;&#xa;	a.subject_code,&#xd;&#xa;  cast&#x28;a.&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;	cast&#x28;a.&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;	a.assistprojectname,  --&#x8f85;&#x52a9;&#x6838;&#x7b97;&#x7684;&#x540d;&#x79f0;&#xd;&#xa;sum&#x28;isnull&#x28;a.period_J,0&#x29;&#x29;-sum&#x28;isnull&#x28;a.period_D,0&#x29;&#x29; AS end2&#xd;&#xa;from YW_YY_EAS_ASSISTBALANCE a --&#x8f85;&#x52a9;&#x8d26;&#x8868;&#xd;&#xa;where &#xd;&#xa; a.assistprojectname&#x3d;&#x27;&#x9884;&#x4ed8;&#x6b3e;&#x27;&#xd;&#xa; AND a.subject_code LIKE &#x27;1123&#x25;&#x27;&#xd;&#xa; AND a.year&#x3e;&#x27;2016&#x27;&#xd;&#xa;GROUP BY&#xd;&#xa;  a.year,&#xd;&#xa;  a.month,&#xd;&#xa;	a.project_code,&#xd;&#xa;	a.subject_code,&#xd;&#xa;	a.assistprojectname &#xd;&#xa;&#x29;--&#x8f85;&#x52a9;&#x6838;&#x7b97;&#x7684;&#x540d;&#x79f0;  &#xd;&#xa;,&#xd;&#xa;&#xd;&#xa;kmfzz_data as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;   a.project_code,&#xd;&#xa;   &#x27;111&#x27; as subject_code,&#xd;&#xa;   a.year,&#xd;&#xa;   a.month,&#xd;&#xa;	 &#x27;1&#x27; as assistprojectname,&#xd;&#xa;   a.end1,&#xd;&#xa;	 b.end2 &#xd;&#xa;  --CASE WHEN a.end1&#x3c;b.end2 THEN a.end1-b.end2 ELSE a.end1-b.end2 END AS end_balance&#xd;&#xa;FROM end_1 a&#xd;&#xa;left JOIN end_2 b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;and a.year&#x3d;b.year&#xd;&#xa;and a.month&#x3d;b.month&#xd;&#xa;&#x29;,&#xd;&#xa;  &#xd;&#xa;pd_data as &#x28;------km-fzz &#x6bcf;&#x4e2a;&#x6708;&#x7684;&#x53d1;&#x751f;&#x989d; &#xff0c;&#x4f7f;&#x5176;&#x79d1;&#x76ee;&#x7f16;&#x7801;&#x6682;&#x65f6;&#x547d;&#x540d;&#x4e3a;11&#xd;&#xa;SELECT &#xd;&#xa;    project_code,&#xd;&#xa;    subject_code,&#xd;&#xa;    year,&#xd;&#xa;    month,&#xd;&#xa;	 assistprojectname,&#xd;&#xa;    isnull&#x28;end1,0&#x29;-isnull&#x28;end2,0&#x29; as end_balance&#xd;&#xa;FROM kmfzz_data&#xd;&#xa;&#x29;,&#xd;&#xa;----&#x81ea;&#x5173;&#x8054;&#x53d6;&#x6bcf;&#x6708;&#x7684;&#x7d2f;&#x8ba1;&#x6570; 1.&#x79d1;&#x76ee;&#x7f16;&#x7801;&#x6682;&#x4e3a;11&#x7684;&#x79d1;&#x76ee;&#x6bcf;&#x6708;&#x7684;&#x7d2f;&#x8ba1;&#x6570;&#x636e; &#xd;&#xa;---2.&#x5224;&#x65ad;&#x8be5;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#x7684;&#x6b63;&#x8d1f; &#x6b63;&#x7684;&#x79d1;&#x76ee;&#x7f16;&#x7801;&#x4e3a;RZ11051030 &#xff0c;&#x8d1f;&#x7684;&#x79d1;&#x76ee;&#x7f16;&#x7801;&#x4e3a; ZC1130&#xd;&#xa;pd_sj as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	a.project_code,&#xd;&#xa;	CASE WHEN SUM&#x28;b.end_balance&#x29;&#x3c;0 THEN &#x27;ZC1130&#x27;  ELSE &#x27;RZ11051030&#x27; end AS subject_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month,&#xd;&#xa;  a.assistprojectname,&#xd;&#xa;	SUM&#x28;b.end_balance&#x29; as end_balance&#xd;&#xa;FROM pd_data a&#xd;&#xa;LEFT JOIN pd_data b&#xd;&#xa;on  a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;GROUP BY &#xd;&#xa;a.project_code,&#xd;&#xa;a.subject_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;a.assistprojectname&#xd;&#xa;&#x29;,&#xd;&#xa;union_sj as &#x28;&#xd;&#xa;SELECT &#x2a; FROM km_data&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT &#x2a; FROM fzz_data&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT &#x2a; FROM EBITDA_SJ&#xd;&#xa;UNION ALL&#xd;&#xa;SELECT &#x2a; FROM cy_data&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT &#x2a; FROM pd_sj&#xd;&#xa;&#x29;,&#xd;&#xa;test_Sj as &#x28;---&#x6570;&#x636e;&#x8868;&#xd;&#xa;select &#xd;&#xa;project_code,&#xd;&#xa;subject_code,&#xd;&#xa;CAST&#x28;year as VARCHAR&#x29;&#x2b;&#x27;-&#x27;&#x2b;right&#x28;&#x27;0&#x27;&#x2b;CAST&#x28;month as VARCHAR&#x29;,2&#x29; as yearmonth,&#xd;&#xa;assistprojectname,&#xd;&#xa;end_balance&#xd;&#xa;from union_sj &#xd;&#xa;&#x29;,&#xd;&#xa;dim_time1 AS &#x28;&#xd;&#xa;select DISTINCT  &#xd;&#xa;LEFT&#x28;the_month,4&#x29;&#x2b;&#x27;-&#x27;&#x2b;RIGHT&#x28;&#x27;0&#x27;&#x2b;the_month,2&#x29; as yearmonth&#xd;&#xa; from Dim_time&#xd;&#xa;WHERE the_month&#x3e;&#x27;201612&#x27;&#xd;&#xa;AND the_month&#x3c;&#x3d;replace&#x28;CONVERT&#x28;VARCHAR&#x28;7&#x29;,GETDATE&#x28;&#x29;,120&#x29;,&#x27;-&#x27;,&#x27;&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;dim_p_d_t as &#x28;--&#x65f6;&#x95f4;&#x5173;&#x8054;&#x9879;&#x76ee;&#x79d1;&#x76ee;&#xd;&#xa;SELECT &#xd;&#xa;a.yearmonth,&#xd;&#xa;b.project_code,&#xd;&#xa;b.project_name,&#xd;&#xa;b.subject_code,&#xd;&#xa;b.subject_name,&#xd;&#xa;b.kj_code,&#xd;&#xa;b.fx,&#xd;&#xa;b.assistprojectname&#xd;&#xa;FROM dim_time1  a&#xd;&#xa;FULL JOIN XMJB_SUBJECT b&#xd;&#xa;ON 1&#x3d;1&#xd;&#xa;&#x29;,&#xd;&#xa; sx_sj as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;a.project_name,&#xd;&#xa;a.project_code,&#xd;&#xa;a.subject_name,&#xd;&#xa;a.subject_code,&#xd;&#xa;SUM&#x28;b.end_balance&#x2a;a.fx&#x29; as end_balance,&#xd;&#xa;a.yearmonth&#xd;&#xa;FROM dim_p_d_t a&#xd;&#xa;LEFT JOIN test_Sj b&#xd;&#xa;on a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.kj_code&#x3d;b.subject_code&#xd;&#xa;AND a.assistprojectname&#x3d;b.assistprojectname&#xd;&#xa;AND a.yearmonth&#x3d;b.yearmonth&#xd;&#xa;GROUP BY &#xd;&#xa;a.yearmonth,&#xd;&#xa;a.project_code,&#xd;&#xa;a.project_name,&#xd;&#xa;a.subject_code,&#xd;&#xa;a.subject_name&#xd;&#xa;&#x29;&#xd;&#xa;SELECT &#x2a; ,GETDATE&#x28;&#x29; as timestamp FROM sx_sj&#xd;&#xa;ORDER BY SUBSTRING&#x28;subject_code,3,30&#x29;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>426</xloc>
      <yloc>78</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x5165; 2</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>BI</connection>
    <sql>WITH NC_ALL_XM AS &#x28;&#xd;&#xa;SELECT distinct&#x28;a.project_code&#x29; as project_code,a.project_name as project_name  &#xd;&#xa;FROM dbo.&#x5b;YW_HS_NC_BI_PROJECT_MAP&#x5d; a&#xd;&#xa;LEFT JOIN YW_HS_PROJECT_BASEINFO b ON a.project_code&#x3d;b.project_code &#xd;&#xa;WHERE b.business IN&#x28;&#x27;&#x5546;&#x573a;&#x27;,&#x27;&#x5199;&#x5b57;&#x697c;&#x27;,&#x27;&#x4ea7;&#x4e1a;&#x56ed;&#x27;&#x29;&#xd;&#xa;AND len&#x28;a.project_code&#x29; &#x3e;0&#xd;&#xa;&#x29;,&#xd;&#xa;SJ AS &#x28;&#xd;&#xa;SELECT  DISTINCT year,month FROM YW_YY_NC_ACCOUNTBALANCE&#xd;&#xa;&#x29;,&#xd;&#xa;ebitda as &#x28;&#xd;&#xa;select&#xd;&#xa;  a.project_code,&#xd;&#xa;	cast&#x28;&#x5b;year&#x5d; as int&#x29; as year,&#xd;&#xa;	cast&#x28;&#x5b;month&#x5d; as int&#x29; as month,&#xd;&#xa;	CASE WHEN a.subject_code&#x3d;&#x27;JYSR.01&#x27; THEN &#x27;SR&#x27; ELSE &#x27;ZC&#x27; END AS subject_code,&#xd;&#xa;	isnull&#x28;a.actual,0&#x29; as actual,&#xd;&#xa;  &#x27;1&#x27; as assistprojectname&#xd;&#xa;from YW_YY_BENEFIT_ANALYST a&#xd;&#xa;where  a.year&#x3e;&#x27;2016&#x27;&#xd;&#xa;AND a.subject_code IN &#x28;&#x27;JYSR.01&#x27;,&#x27;JYZC.01&#x27;&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;ebitda_data AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;	a.project_code,&#xd;&#xa;	a.subject_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month,&#xd;&#xa;	SUM&#x28;b.actual&#x29; as end_balance&#xd;&#xa;FROM ebitda a&#xd;&#xa;INNER JOIN ebitda b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;GROUP BY &#xd;&#xa;	a.project_code,&#xd;&#xa;	a.subject_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month&#xd;&#xa;&#x29;,&#xd;&#xa;ebitda_ok as&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,&#xd;&#xa;	year,&#xd;&#xa;	month,&#xd;&#xa;	&#x27;LR1010&#x27; as subject_code,&#xd;&#xa;	&#x27;1&#x27; as assistprojectname,&#xd;&#xa;	&#x28;SR-ZC&#x29;&#x2a;10000 AS EBITDA&#xd;&#xa;FROM ebitda_data&#xd;&#xa;PIVOT&#xd;&#xa;&#x28;&#xd;&#xa;    SUM&#x28;end_balance&#x29; for subject_code in&#x28;SR,ZC&#x29;&#xd;&#xa;&#x29;TBL&#xd;&#xa;&#x29;,&#xd;&#xa;EBITDA1_SJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;subject_code,&#xd;&#xa;assistprojectname,&#xd;&#xa;EBITDA FROM ebitda_ok &#xd;&#xa;WHERE project_code IN &#x28;SELECT project_code FROM YW_HS_NC_BI_PROJECT_MAP&#x29;&#xd;&#xa;&#x29;,----&#x8d44;&#x91d1;&#x8868;EBITDA1&#x7684;&#x53d6;&#x503c;&#xd;&#xa; NC_JTZCZJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;period_D-period_J AS JTZCZJ&#xd;&#xa;FROM YW_YY_NC_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code&#x3d;&#x27;224101&#x27;&#xd;&#xa;&#x29;,--NC&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;NC_JTZCZJ_LJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;t1.project_code,&#xd;&#xa;t1.project_name,&#xd;&#xa;t1.subject_code,&#xd;&#xa;t1.subject_name,&#xd;&#xa;t1.year,&#xd;&#xa;t1.month,&#xd;&#xa;SUM&#x28;t2.JTZCZJ&#x29; AS JTZCZJ_LJ&#xd;&#xa;FROM NC_JTZCZJ t1&#xd;&#xa;LEFT JOIN NC_JTZCZJ t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.subject_name&#x3d;t2.subject_name&#xd;&#xa;WHERE t1.year&#x3d;t2.year &#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY &#xd;&#xa;t1.project_code,&#xd;&#xa;t1.project_name,&#xd;&#xa;t1.subject_code,&#xd;&#xa;t1.subject_name,&#xd;&#xa;t1.year,&#xd;&#xa;t1.month&#xd;&#xa;&#x29;,--NC&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#x7d2f;&#x8ba1;&#x53d1;&#x751f;&#x989d;&#xd;&#xa;NC_JTZCZJ_LJ_ZF AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;case when JTZCZJ_LJ&#x3e;&#x3d;0 then &#x27;Z224101&#x27;&#xd;&#xa;ELSE &#x27;F224101&#x27; END  AS subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;JTZCZJ_LJ&#xd;&#xa;FROM NC_JTZCZJ_LJ&#xd;&#xa;&#x29;,----NC&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#x7d2f;&#x8ba1;&#x53d1;&#x751f;&#x989d;&#x6839;&#x636e;&#x6b63;&#x8d1f;&#x8d4b;&#x4e88;&#x7f16;&#x7801;&#xd;&#xa; NC_DSCCB AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101020&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as DSCCB_VALUE&#xd;&#xa;FROM YW_YY_NC_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1409&#x27;,&#x27;16010106&#x27;,&#x27;1521010106&#x27;,&#x27;160406&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--NC_&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;NC_DSCCB_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.DSCCB_VALUE&#x29; AS DSCCB_LJ&#xd;&#xa;FROM NC_DSCCB t1&#xd;&#xa;LEFT JOIN NC_DSCCB t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.subject_name&#x3d;t2.subject_name&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--NC_&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;NC_DSCCB_LJ_ZF AS  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN DSCCB_LJ&#x3e;&#x3d;0 THEN 0-DSCCB_LJ&#xd;&#xa;ELSE DSCCB_LJ END AS DSCCB_LJ_ZF&#xd;&#xa;FROM NC_DSCCB_LJ&#xd;&#xa;&#x29;,--NC_&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x4ee5;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa; NC_KBF AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101040&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5f00;&#x529e;&#x8d39;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as KBF_VALUE&#xd;&#xa;FROM YW_YY_NC_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;180102&#x27;,&#x27;1801010101&#x27;,&#xd;&#xa;&#x27;1801010102&#x27;,&#x27;1801080504&#x27;,&#xd;&#xa;&#x27;1801080523&#x27;,&#x27;1801080540&#x27;,&#x27;18010804&#x27;,&#x27;180111&#x27;,&#x27;180199&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--NC_&#x5f00;&#x529e;&#x8d39;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;NC_KBF_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.KBF_VALUE&#x29; AS KBF_LJ&#xd;&#xa;FROM NC_KBF  t1&#xd;&#xa;LEFT JOIN NC_KBF  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.subject_name&#x3d;t2.subject_name&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--NC&#x5f00;&#x529e;&#x8d39;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;NC_KBF_LJ_ZF AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN KBF_LJ&#x3e;&#x3d;0 THEN 0-KBF_LJ&#xd;&#xa;ELSE KBF_LJ END AS KBF_LJ_ZF&#xd;&#xa;FROM NC_KBF_LJ&#xd;&#xa;&#x29;,--NC&#x5f00;&#x529e;&#x8d39;&#x6570;&#x636e;&#x4ee5;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa; NC_KYQFY AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101050&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as KYQFY_VALUE&#xd;&#xa;FROM YW_YY_NC_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1801080121&#x27;,&#x27;1801080122&#x27;,&#x27;1801080123&#x27;,&#x27;18010802&#x27;,&#x27;1801080501&#x27;,&#xd;&#xa;&#x27;1801080601&#x27;,&#x27;1801080602&#x27;,&#x27;1801080604&#x27;,&#x27;1801080605&#x27;,&#x27;1801080606&#x27;,&#x27;1801080607&#x27;,&#x27;1801080608&#x27;,&#xd;&#xa;&#x27;18010899&#x27;,&#x27;1801080123&#x27;,&#x27;1801080503&#x27;,&#x27;1801080603&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--NC_&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;NC_KYQFY_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.KYQFY_VALUE&#x29; AS KYQFY_VALUE_LJ&#xd;&#xa;FROM NC_KYQFY  t1&#xd;&#xa;LEFT JOIN NC_KYQFY  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.subject_name&#x3d;t2.subject_name&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--NC_&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;NC_KYQFY_LJ_ZF AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN KYQFY_VALUE_LJ&#x3e;&#x3d;0 THEN 0-KYQFY_VALUE_LJ&#xd;&#xa;ELSE KYQFY_VALUE_LJ END AS KYQFY_VALUE_LJ_ZF&#xd;&#xa;FROM NC_KYQFY_LJ&#xd;&#xa;&#x29;,--NC_&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#x4ee5;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa; NC_TZXGZZC AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101060&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as TZXGZZC_VALUE&#xd;&#xa;FROM YW_YY_NC_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1403&#x27;,&#x27;1411&#x27;,&#x27;160401&#x27;,&#x27;16040188&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--NC_&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;NC_TZXGZZC_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.TZXGZZC_VALUE&#x29; AS TZXGZZC_VALUE_LJ&#xd;&#xa;FROM NC_TZXGZZC  t1&#xd;&#xa;LEFT JOIN NC_TZXGZZC  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.subject_name&#x3d;t2.subject_name&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--NC_&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;NC_TZXGZZC_LJ_ZF AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN TZXGZZC_VALUE_LJ&#x3e;&#x3d;0 THEN 0-TZXGZZC_VALUE_LJ&#xd;&#xa;ELSE TZXGZZC_VALUE_LJ END AS TZXGZZC_VALUE_LJ_ZF&#xd;&#xa;FROM NC_TZXGZZC_LJ&#xd;&#xa;&#x29;,--NC_&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#x4f9d;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa;NC_KMYE AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,&#xd;&#xa;	project_name,&#xd;&#xa;	subject_code,&#xd;&#xa;	subject_name,&#xd;&#xa;  year,&#xd;&#xa;  month,&#xd;&#xa;	CASE	WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;1&#x27; THEN sum&#x28;period_J&#x29;-sum&#x28;period_D&#x29;&#xd;&#xa;        WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;2&#x27; THEN sum&#x28;period_D&#x29;-sum&#x28;period_J&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;4&#x27; THEN sum&#x28;period_D&#x29;-sum&#x28;period_J&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;5&#x27; THEN sum&#x28;period_J&#x29;-SUM&#x28;period_D&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;60&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;61&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;62&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;63&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;64&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;65&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;66&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;67&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;68&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690101&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690102&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690103&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690104&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690105&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690106&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690107&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690108&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690109&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690110&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690111&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690112&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690113&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;690114&#x27; THEN sum&#x28;period_FS&#x29; &#xd;&#xa;		 ELSE NULL END AS end_balance --&#x671f;&#x672b;&#x4f59;&#x989d;&#xd;&#xa;from YW_YY_NC_ACCOUNTBALANCE --&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x8868;&#xd;&#xa;GROUP BY project_code,&#xd;&#xa;	project_name,&#xd;&#xa;	subject_code,&#xd;&#xa;	subject_name,&#xd;&#xa;  year,&#xd;&#xa;  month&#xd;&#xa;&#x29;,--NC_&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;NC_KMYE_LJ AS  &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.end_balance&#x29; AS end_balance_LJ&#xd;&#xa;FROM NC_KMYE  t1&#xd;&#xa;LEFT JOIN NC_KMYE  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.subject_name&#x3d;t2.subject_name&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month  &#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--NC_&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x5e74;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;NC_ALL_XMKMSJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;t1.project_code,&#xd;&#xa;t1.project_name,&#xd;&#xa;t2.year,&#xd;&#xa;t2.month,&#xd;&#xa;t3.subject_code,&#xd;&#xa;t3.subject_name,&#xd;&#xa;t3.kj_code,&#xd;&#xa;t3.fx&#xd;&#xa;FROM NC_ALL_XM t1&#xd;&#xa;FULL JOIN SJ t2&#xd;&#xa;ON 1&#x3d;1&#xd;&#xa;FULL JOIN YW_BI_EAS_SUBJECT_MAP t3&#xd;&#xa;ON 1&#x3d;1&#xd;&#xa;WHERE t3.source&#x3d;&#x27;NC&#x27;&#xd;&#xa;&#x29;,--NC&#x6240;&#x6709;&#x9879;&#x76ee;&#x6240;&#x6709;&#x65f6;&#x95f4;&#xff0c;&#x6240;&#x6709;&#x7684;&#x79d1;&#x76ee;&#x6620;&#x5c04;&#xd;&#xa;NC_ALLXM_SJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;tt.project_code AS project_code,&#xd;&#xa;tt.project_name AS project_name,&#xd;&#xa;tt.year AS year,&#xd;&#xa;tt.month AS MONTH,&#xd;&#xa;tt.subject_code AS subject_code,&#xd;&#xa;tt.subject_name AS subject_name,&#xd;&#xa;tt.kj_code AS kj_code,&#xd;&#xa;tt.fx AS fx,&#xd;&#xa;isnull&#x28;tt1.EBITDA,0&#x29; AS EBITDA,                     --ebitda&#x53d6;&#x503c;&#xd;&#xa;isnull&#x28;tt2.JTZCZJ_LJ,0&#x29; AS JTZCZJ_LJ,               --&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#xd;&#xa;isnull&#x28;tt3.DSCCB_LJ_ZF,0&#x29; AS DSCCB_LJ_ZF,           --&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#xd;&#xa;isnull&#x28;tt4.KBF_LJ_ZF,0&#x29; AS KBF_LJ_ZF,               --&#x5f00;&#x529e;&#x8d39;&#x53d6;&#x503c;&#xd;&#xa;isnull&#x28;tt5.KYQFY_VALUE_LJ_ZF,0&#x29; AS KYQFY_VALUE_LJ_ZF, --&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#xd;&#xa;isnull&#x28;tt6.TZXGZZC_VALUE_LJ_ZF,0&#x29; AS TZXGZZC_VALUE_LJ_ZF, --&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#xd;&#xa;isnull&#x28;tt7.end_balance_LJ,0&#x29;  AS end_balance_LJ&#xd;&#xa;FROM NC_ALL_XMKMSJ tt&#xd;&#xa;LEFT JOIN ebitda_ok tt1 --ebitda&#x53d6;&#x503c;&#xd;&#xa;ON tt.project_code&#x3d;tt1.project_code &#xd;&#xa;AND tt.year&#x3d;tt1.year &#xd;&#xa;AND tt.month&#x3d;tt1.month&#xd;&#xa;AND tt.kj_code&#x3d;tt1.subject_code&#xd;&#xa;LEFT JOIN NC_JTZCZJ_LJ_ZF tt2 --&#x53d6;&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#xd;&#xa;ON tt.project_code&#x3d;tt2.project_code&#xd;&#xa;AND tt.year&#x3d;tt2.year&#xd;&#xa;AND tt.month&#x3d;tt2.month&#xd;&#xa;AND tt.kj_code&#x3d;tt2.subject_code&#xd;&#xa;LEFT JOIN NC_DSCCB_LJ_ZF tt3 --&#x53d6;&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#xd;&#xa;ON tt.project_code&#x3d;tt3.project_code&#xd;&#xa;AND tt.year&#x3d;tt3.year&#xd;&#xa;AND tt.month&#x3d;tt3.month&#xd;&#xa;AND tt.kj_code&#x3d;tt3.subject_code&#xd;&#xa;LEFT JOIN NC_KBF_LJ_ZF tt4  --&#x53d6;&#x5f00;&#x529e;&#x8d39;&#xd;&#xa;ON tt.project_code&#x3d;tt4.project_code&#xd;&#xa;AND tt.year&#x3d;tt4.year&#xd;&#xa;AND tt.month&#x3d;tt4.month&#xd;&#xa;AND tt.kj_code&#x3d;tt4.subject_code&#xd;&#xa;LEFT JOIN NC_KYQFY_LJ_ZF tt5   --&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#xd;&#xa;ON tt.project_code&#x3d;tt5.project_code&#xd;&#xa;AND tt.year&#x3d;tt5.year&#xd;&#xa;AND tt.month&#x3d;tt5.month&#xd;&#xa;AND tt.kj_code&#x3d;tt5.subject_code&#xd;&#xa;LEFT JOIN NC_TZXGZZC_LJ_ZF tt6   --&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#xd;&#xa;ON tt.project_code&#x3d;tt6.project_code&#xd;&#xa;AND tt.year&#x3d;tt6.year&#xd;&#xa;AND tt.month&#x3d;tt6.month&#xd;&#xa;AND tt.kj_code&#x3d;tt6.subject_code&#xd;&#xa;LEFT JOIN NC_KMYE_LJ tt7&#xd;&#xa; ON tt.project_code&#x3d;tt7.project_code&#xd;&#xa;AND tt.year&#x3d;tt7.year&#xd;&#xa;AND tt.month&#x3d;tt7.month&#xd;&#xa;AND tt.kj_code&#x3d;tt7.subject_code&#xd;&#xa;&#x29;,&#xd;&#xa;ALL_NCXM_KMSJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;MONTH,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;kj_code,&#xd;&#xa;fx,&#xd;&#xa;EBITDA&#x2b;JTZCZJ_LJ&#x2b;DSCCB_LJ_ZF&#x2b;KBF_LJ_ZF&#x2b;KYQFY_VALUE_LJ_ZF&#x2b;TZXGZZC_VALUE_LJ_ZF&#x2b;end_balance_LJ AS VALUE_SJ&#xd;&#xa;FROM NC_ALLXM_SJ &#xd;&#xa;&#x29;,&#xd;&#xa;NC_ZJB_SJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;MONTH,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;SUM&#x28;fx&#x2a;VALUE_SJ&#x29; AS SJ&#xd;&#xa;FROM ALL_NCXM_KMSJ&#xd;&#xa;GROUP BY project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;MONTH,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name&#xd;&#xa;&#x29;,--nc&#x8d44;&#x91d1;&#x8868;&#xff0c;NC&#x53d6;&#x6570;&#x9879;&#x76ee;ok&#xd;&#xa;EAS_JTZCZJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;period_D-period_J AS JTZCZJ&#xd;&#xa;FROM YW_YY_EAS_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code&#x3d;&#x27;2241.01&#x27; &#xd;&#xa;AND project_code IN &#x28;&#x27;SH_HSH_QPMGTD&#x27;,&#x27;CD_A4_XZL&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;&#x29;,--EAS&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;EAS_JTZCZJ_LJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;t1.project_code,&#xd;&#xa;t1.project_name,&#xd;&#xa;t1.subject_code,&#xd;&#xa;t1.subject_name,&#xd;&#xa;t1.year,&#xd;&#xa;t1.month,&#xd;&#xa;SUM&#x28;t2.JTZCZJ&#x29; AS JTZCZJ_LJ&#xd;&#xa;FROM EAS_JTZCZJ t1&#xd;&#xa;LEFT JOIN EAS_JTZCZJ t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;WHERE t1.year&#x3d;t2.year &#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY &#xd;&#xa;t1.project_code,&#xd;&#xa;t1.project_name,&#xd;&#xa;t1.subject_code,&#xd;&#xa;t1.subject_name,&#xd;&#xa;t1.year,&#xd;&#xa;t1.month&#xd;&#xa;&#x29;,--EAS&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#x7d2f;&#x8ba1;&#x53d1;&#x751f;&#x989d;&#xd;&#xa;EAS_JTZCZJ_LJ_ZF AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;case when JTZCZJ_LJ&#x3e;0 then &#x27;Z2241.01&#x27;&#xd;&#xa;ELSE &#x27;F2241.01&#x27; END  AS subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;JTZCZJ_LJ&#xd;&#xa;FROM EAS_JTZCZJ_LJ&#xd;&#xa;&#x29;,----EAS&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#x7d2f;&#x8ba1;&#x53d1;&#x751f;&#x989d;&#x6839;&#x636e;&#x6b63;&#x8d1f;&#x8d4b;&#x4e88;&#x7f16;&#x7801;&#xd;&#xa;EAS_DSCCB AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101020&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as DSCCB_VALUE&#xd;&#xa;FROM YW_YY_EAS_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1409&#x27;,&#x27;1601.01.06&#x27;,&#x27;1521.01.01.06&#x27;,&#x27;1604.06&#x27;&#x29;&#xd;&#xa;AND project_code IN &#x28;&#x27;SH_HSH_QPMGTD&#x27;,&#x27;CD_A4_XZL&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--EAS_&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;EAS_DSCCB_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.DSCCB_VALUE&#x29; AS DSCCB_LJ&#xd;&#xa;FROM EAS_DSCCB t1&#xd;&#xa;LEFT JOIN EAS_DSCCB t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--EAS_&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;EAS_DSCCB_LJ_ZF AS  &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN DSCCB_LJ&#x3e;&#x3d;0 THEN 0-DSCCB_LJ&#xd;&#xa;ELSE DSCCB_LJ END AS DSCCB_LJ_ZF&#xd;&#xa;FROM EAS_DSCCB_LJ&#xd;&#xa;&#x29;,--EAS_&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#x4ee5;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa;EAS_KBF AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101040&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5f00;&#x529e;&#x8d39;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as KBF_VALUE&#xd;&#xa;FROM YW_YY_EAS_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1801.02&#x27;,&#x27;1801.01.01.01&#x27;,&#xd;&#xa;&#x27;1801.01.01.02&#x27;,&#x27;1801.08.05.04&#x27;,&#xd;&#xa;&#x27;1801.08.05.23&#x27;,&#x27;1801.08.05.40&#x27;,&#x27;1801.08.04&#x27;,&#x27;1801.11&#x27;,&#x27;1801.99&#x27;&#x29;&#xd;&#xa;AND project_code IN &#x28;&#x27;SH_HSH_QPMGTD&#x27;,&#x27;CD_A4_XZL&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--EAS_&#x5f00;&#x529e;&#x8d39;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;EAS_KBF_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.KBF_VALUE&#x29; AS KBF_LJ&#xd;&#xa;FROM EAS_KBF  t1&#xd;&#xa;LEFT JOIN EAS_KBF  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--EAS&#x5f00;&#x529e;&#x8d39;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;EAS_KBF_LJ_ZF AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN KBF_LJ&#x3e;&#x3d;0 THEN 0-KBF_LJ&#xd;&#xa;ELSE KBF_LJ END AS KBF_LJ_ZF&#xd;&#xa;FROM EAS_KBF_LJ&#xd;&#xa;&#x29;,--EAS&#x5f00;&#x529e;&#x8d39;&#x6570;&#x636e;&#x4ee5;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa;EAS_KYQFY AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101050&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as KYQFY_VALUE&#xd;&#xa;FROM YW_YY_EAS_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1801.08.01.21&#x27;,&#x27;1801.08.01.22&#x27;,&#x27;1801.08.01.23&#x27;,&#x27;1801.08.02&#x27;,&#x27;1801.08.05.01&#x27;,&#xd;&#xa;&#x27;1801.08.06.01&#x27;,&#x27;1801.08.06.02&#x27;,&#x27;1801.08.06.04&#x27;,&#x27;1801.08.06.05&#x27;,&#x27;1801.08.06.06&#x27;,&#x27;1801.08.06.07&#x27;,&#xd;&#xa;&#x27;1801.08.06.08&#x27;,&#x27;1801.08.99&#x27;,&#x27;1801.08.01.23&#x27;,&#x27;1801.08.05.03&#x27;,&#x27;1801.08.06.03&#x27;&#x29;&#xd;&#xa;AND project_code IN &#x28;&#x27;SH_HSH_QPMGTD&#x27;,&#x27;CD_A4_XZL&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--EAS_&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;EAS_KYQFY_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.KYQFY_VALUE&#x29; AS KYQFY_VALUE_LJ&#xd;&#xa;FROM EAS_KYQFY  t1&#xd;&#xa;LEFT JOIN EAS_KYQFY  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--EAS_&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;EAS_KYQFY_LJ_ZF AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN KYQFY_VALUE_LJ&#x3e;&#x3d;0 THEN 0-KYQFY_VALUE_LJ&#xd;&#xa;ELSE KYQFY_VALUE_LJ END AS KYQFY_VALUE_LJ_ZF&#xd;&#xa;FROM EAS_KYQFY_LJ&#xd;&#xa;&#x29;,--EAS_&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#x4ee5;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa;EAS_TZXGZZC AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;&#x27;ZC11101060&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x27; AS subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;SUM&#x28;period_J&#x29;-SUM&#x28;period_D&#x29; as TZXGZZC_VALUE&#xd;&#xa;FROM YW_YY_EAS_ACCOUNTBALANCE&#xd;&#xa;WHERE subject_code IN &#x28;&#x27;1403&#x27;,&#x27;1411&#x27;,&#x27;1604.01&#x27;,&#x27;1604.01.88&#x27;&#x29;&#xd;&#xa;AND project_code IN &#x28;&#x27;SH_HSH_QPMGTD&#x27;,&#x27;CD_A4_XZL&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month&#xd;&#xa;&#x29;,--EAS_&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;EAS_TZXGZZC_LJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.TZXGZZC_VALUE&#x29; AS TZXGZZC_VALUE_LJ&#xd;&#xa;FROM EAS_TZXGZZC  t1&#xd;&#xa;LEFT JOIN EAS_TZXGZZC  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month&#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--EAS_&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;EAS_TZXGZZC_LJ_ZF AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;CASE WHEN TZXGZZC_VALUE_LJ&#x3e;&#x3d;0 THEN 0-TZXGZZC_VALUE_LJ&#xd;&#xa;ELSE TZXGZZC_VALUE_LJ END AS TZXGZZC_VALUE_LJ_ZF&#xd;&#xa;FROM EAS_TZXGZZC_LJ&#xd;&#xa;&#x29;,--EAS_&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#x652f;&#x51fa;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#x4f9d;&#x8d1f;&#x6570;&#x663e;&#x793a;&#xd;&#xa;EAS_KMYE AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,&#xd;&#xa;	project_name,&#xd;&#xa;	subject_code,&#xd;&#xa;	subject_name,&#xd;&#xa;  year,&#xd;&#xa;  month,&#xd;&#xa;	CASE	WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;1&#x27; THEN sum&#x28;period_J&#x29;-sum&#x28;period_D&#x29;&#xd;&#xa;        WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;2&#x27; THEN sum&#x28;period_D&#x29;-sum&#x28;period_J&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;4&#x27; THEN sum&#x28;period_D&#x29;-sum&#x28;period_J&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,1&#x29;&#x3d;&#x27;5&#x27; THEN sum&#x28;period_J&#x29;-SUM&#x28;period_D&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;60&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;61&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;62&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;63&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;64&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;65&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;66&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;67&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,2&#x29;&#x3d;&#x27;68&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.01&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.02&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.03&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.04&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.05&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.06&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.07&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.08&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.09&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.10&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.11&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.12&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.13&#x27; THEN sum&#x28;period_FS&#x29;&#xd;&#xa;		 WHEN LEFT&#x28;subject_code,7&#x29;&#x3d;&#x27;6901.14&#x27; THEN sum&#x28;period_FS&#x29; &#xd;&#xa;		 ELSE NULL END AS end_balance --&#x671f;&#x672b;&#x4f59;&#x989d;&#xd;&#xa;from YW_YY_EAS_ACCOUNTBALANCE --&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x8868;&#xd;&#xa;WHERE  project_code IN &#x28;&#x27;SH_HSH_QPMGTD&#x27;,&#x27;CD_A4_XZL&#x27;,&#x27;SZ_ZJ_GJZX&#x27;&#x29;&#xd;&#xa;GROUP BY project_code,&#xd;&#xa;	project_name,&#xd;&#xa;	subject_code,&#xd;&#xa;	subject_name,&#xd;&#xa;  year,&#xd;&#xa;  month&#xd;&#xa;&#x29;,--EAS_&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x672c;&#x671f;&#x6570;&#x636e;&#xd;&#xa;EAS_KMYE_LJ AS  &#x28;&#xd;&#xa;SELECT&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month,&#xd;&#xa;SUM&#x28;t2.end_balance&#x29; AS end_balance_LJ&#xd;&#xa;FROM EAS_KMYE  t1&#xd;&#xa;LEFT JOIN EAS_KMYE  t2&#xd;&#xa;ON t1.project_code&#x3d;t2.project_code&#xd;&#xa;AND t1.project_name&#x3d;t2.project_name&#xd;&#xa;AND t1.subject_code&#x3d;t2.subject_code&#xd;&#xa;AND t1.year&#x3d;t2.year&#xd;&#xa;WHERE t1.year&#x3d;t2.year&#xd;&#xa;AND t1.month&#x3e;&#x3d;t2.month  &#xd;&#xa;GROUP BY&#xd;&#xa; t1.project_code,&#xd;&#xa; t1.project_name,&#xd;&#xa; t1.subject_code,&#xd;&#xa; t1.subject_name,&#xd;&#xa; t1.year,&#xd;&#xa; t1.month&#xd;&#xa;&#x29;,--EAS_&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x5e74;&#x7d2f;&#x8ba1;&#x6570;&#x636e;&#xd;&#xa;EAS_ALL_XMKMSJ AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;t1.project_code,&#xd;&#xa;t1.project_name,&#xd;&#xa;t2.year,&#xd;&#xa;t2.month,&#xd;&#xa;t3.subject_code,&#xd;&#xa;t3.subject_name,&#xd;&#xa;t3.EAS_kj_code,&#xd;&#xa;t3.fx&#xd;&#xa;FROM NC_ALL_XM t1&#xd;&#xa;FULL JOIN SJ t2&#xd;&#xa;ON 1&#x3d;1&#xd;&#xa;FULL JOIN YW_BI_EAS_SUBJECT_MAP t3&#xd;&#xa;ON 1&#x3d;1&#xd;&#xa;WHERE t3.source&#x3d;&#x27;NC&#x27;&#xd;&#xa;&#x29;,--NC&#x53d6;EAS&#x90e8;&#x5206;&#x9879;&#x76ee;&#x6240;&#x6709;&#x65f6;&#x95f4;&#xff0c;&#x6240;&#x6709;&#x7684;&#x79d1;&#x76ee;&#x6620;&#x5c04;&#xd;&#xa;EAS_ALLXM_SJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;f.project_code,&#xd;&#xa;f.project_name,&#xd;&#xa;f.year,&#xd;&#xa;f.month,&#xd;&#xa;f.subject_code,&#xd;&#xa;f.subject_name,&#xd;&#xa;f.EAS_kj_code,&#xd;&#xa;f.fx,&#xd;&#xa;isnull&#x28;f1.JTZCZJ_LJ,0&#x29; AS JTZCZJ_LJ,                --EAS&#x90e8;&#x5206;&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#xd;&#xa;isnull&#x28;f2.DSCCB_LJ_ZF,0&#x29; AS DSCCB_LJ_ZF,               --EAS&#x90e8;&#x5206;&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#xd;&#xa;isnull&#x28;f3.KBF_LJ_ZF,0&#x29; AS KBF_LJ_ZF,                 --EAS&#x90e8;&#x5206;&#x5f00;&#x529e;&#x8d39;&#xd;&#xa;isnull&#x28;f4.KYQFY_VALUE_LJ_ZF,0&#x29; AS KYQFY_VALUE_LJ_ZF,          --EAS&#x90e8;&#x5206;&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#xd;&#xa;isnull&#x28;f5.TZXGZZC_VALUE_LJ_ZF,0&#x29; AS TZXGZZC_VALUE_LJ_ZF,        --EAS&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#xd;&#xa;isnull&#x28;f6.end_balance_LJ,0&#x29; AS end_balance_LJ&#xd;&#xa;FROM EAS_ALL_XMKMSJ f&#xd;&#xa;LEFT JOIN EAS_JTZCZJ_LJ_ZF f1                 --EAS&#x90e8;&#x5206;&#x96c6;&#x56e2;&#x652f;&#x6301;&#x8d44;&#x91d1;&#xd;&#xa;ON f.project_code&#x3d;f1.project_code&#xd;&#xa;AND f.year&#x3d;f1.year&#xd;&#xa;AND f.month&#x3d;f1.month&#xd;&#xa;AND f.EAS_kj_code&#x3d;f1.subject_code&#xd;&#xa;LEFT JOIN EAS_DSCCB_LJ_ZF f2                  --EAS&#x90e8;&#x5206;&#x5927;&#x751f;&#x4ea7;&#x6210;&#x672c;&#xd;&#xa;ON f.project_code&#x3d;f2.project_code&#xd;&#xa;AND f.year&#x3d;f2.year&#xd;&#xa;AND f.month&#x3d;f2.month&#xd;&#xa;AND f.EAS_kj_code&#x3d;f2.subject_code&#xd;&#xa;LEFT JOIN  EAS_KBF_LJ_ZF f3                   --EAS&#x90e8;&#x5206;&#x5f00;&#x529e;&#x8d39;&#xd;&#xa;ON f.project_code&#x3d;f3.project_code&#xd;&#xa;AND f.year&#x3d;f3.year&#xd;&#xa;AND f.month&#x3d;f3.month&#xd;&#xa;AND f.EAS_kj_code&#x3d;f3.subject_code&#xd;&#xa;LEFT JOIN EAS_KYQFY_LJ_ZF f4                   --EAS&#x90e8;&#x5206;&#x5f00;&#x4e1a;&#x524d;&#x8d39;&#x7528;&#xd;&#xa;ON f.project_code&#x3d;f4.project_code&#xd;&#xa;AND f.year&#x3d;f4.year&#xd;&#xa;AND f.month&#x3d;f4.month&#xd;&#xa;AND f.EAS_kj_code&#x3d;f4.subject_code&#xd;&#xa;LEFT JOIN EAS_TZXGZZC_LJ_ZF f5                --EAS&#x6295;&#x8d44;&#x6027;&#x6539;&#x9020;&#xd;&#xa;ON f.project_code&#x3d;f5.project_code&#xd;&#xa;AND f.year&#x3d;f5.year&#xd;&#xa;AND f.month&#x3d;f5.month&#xd;&#xa;AND f.EAS_kj_code&#x3d;f5.subject_code&#xd;&#xa;LEFT JOIN EAS_KMYE_LJ f6                      --EAS&#x79d1;&#x76ee;&#x4f59;&#x989d;&#x8868;&#xd;&#xa;ON f.project_code&#x3d;f6.project_code&#xd;&#xa;AND f.year&#x3d;f6.year&#xd;&#xa;AND f.month&#x3d;f6.month&#xd;&#xa;AND f.EAS_kj_code&#x3d;f6.subject_code&#xd;&#xa;&#x29;,&#xd;&#xa;EAS_ZJB_SJ AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;EAS_kj_code,&#xd;&#xa;fx,&#xd;&#xa;JTZCZJ_LJ&#x2b;DSCCB_LJ_ZF&#x2b;KBF_LJ_ZF&#x2b;KYQFY_VALUE_LJ_ZF&#x2b;TZXGZZC_VALUE_LJ_ZF&#x2b;end_balance_LJ AS end_value&#xd;&#xa;FROM EAS_ALLXM_SJ&#xd;&#xa;&#x29;,&#xd;&#xa;EAS_ZJB_SJ_OK AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name,&#xd;&#xa;SUM&#x28;fx&#x2a;end_value&#x29; AS values_ok&#xd;&#xa;FROM EAS_ZJB_SJ&#xd;&#xa;GROUP BY &#xd;&#xa;project_code,&#xd;&#xa;project_name,&#xd;&#xa;year,&#xd;&#xa;month,&#xd;&#xa;subject_code,&#xd;&#xa;subject_name&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT &#xd;&#xa;T1.project_name,&#xd;&#xa;T1.project_code,&#xd;&#xa;T1.subject_name,&#xd;&#xa;T1.subject_code,&#xd;&#xa;T1.SJ&#x2b;T2.values_ok AS end_balance,&#xd;&#xa;CONVERT&#x28;VARCHAR&#x28;7&#x29;,cast&#x28;T1.year as VARCHAR&#x28;4&#x29;&#x29;&#x2b;&#x27;-&#x27;&#x2b;RIGHT&#x28;&#x27;0&#x27;&#x2b;cast&#x28;T1.MONTH as VARCHAR&#x28;2&#x29;&#x29;,2&#x29;&#x2b;&#x27;-01&#x27;,23&#x29; AS yearmonth,&#xd;&#xa;GETDATE&#x28;&#x29; as timestamp&#xd;&#xa;FROM NC_ZJB_SJ  T1&#xd;&#xa;LEFT JOIN EAS_ZJB_SJ_OK  T2&#xd;&#xa;ON T1.project_code&#x3d;T2.project_code&#xd;&#xa;AND T1.YEAR&#x3d;T2.YEAR&#xd;&#xa;AND T1.MONTH&#x3d;T2.MONTH&#xd;&#xa;AND T1.subject_code&#x3d;T2.subject_code&#xd;&#xa;--WHERE T1.year&#x3d;&#x27;2017&#x27; AND T1.MONTH&#x3d;&#x27;12&#x27;&#xd;&#xa;ORDER BY T1.project_code,SUBSTRING&#x28;T1.subject_code,3,28&#x29;&#xd;&#xa;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>427</xloc>
      <yloc>201</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x8d44;&#x91d1;&#x8868;&#x8f93;&#x51fa;</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>BI</connection>
    <schema/>
    <table>YW_YY_CAPITAL_ANALYST</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>project_name</column_name>
          <stream_name>project_name</stream_name>
        </field>
        <field>
          <column_name>project_code</column_name>
          <stream_name>project_code</stream_name>
        </field>
        <field>
          <column_name>subject_name</column_name>
          <stream_name>subject_name</stream_name>
        </field>
        <field>
          <column_name>subject_code</column_name>
          <stream_name>subject_code</stream_name>
        </field>
        <field>
          <column_name>end_balance</column_name>
          <stream_name>end_balance</stream_name>
        </field>
        <field>
          <column_name>yearmonth</column_name>
          <stream_name>yearmonth</stream_name>
        </field>
        <field>
          <column_name>timestamp</column_name>
          <stream_name>timestamp</stream_name>
        </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>586</xloc>
      <yloc>140</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
