<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>&#x53d6;&#x5230;&#x7ed3;&#x679c;&#x8868;1</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>&#x2f;</directory>
    <parameters>
    </parameters>
    <log>
<trans-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name><subject/></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name><subject/></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name><subject/></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name><subject/></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name><subject/></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name><subject/></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></trans-log-table>
<perf-log-table><connection/>
<schema/>
<table/>
<interval/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>SEQ_NR</id><enabled>Y</enabled><name>SEQ_NR</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>INPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>INPUT_BUFFER_ROWS</name></field><field><id>OUTPUT_BUFFER_ROWS</id><enabled>Y</enabled><name>OUTPUT_BUFFER_ROWS</name></field></perf-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
<step-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>TRANSNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>STEPNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>STEP_COPY</id><enabled>Y</enabled><name>STEP_COPY</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field></step-log-table>
<metrics-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>METRICS_DATE</id><enabled>Y</enabled><name>METRICS_DATE</name></field><field><id>METRICS_CODE</id><enabled>Y</enabled><name>METRICS_CODE</name></field><field><id>METRICS_DESCRIPTION</id><enabled>Y</enabled><name>METRICS_DESCRIPTION</name></field><field><id>METRICS_SUBJECT</id><enabled>Y</enabled><name>METRICS_SUBJECT</name></field><field><id>METRICS_TYPE</id><enabled>Y</enabled><name>METRICS_TYPE</name></field><field><id>METRICS_VALUE</id><enabled>Y</enabled><name>METRICS_VALUE</name></field></metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
  <created_user>-</created_user>
  <created_date>2017&#x2f;08&#x2f;08 14&#x3a;56&#x3a;30.436</created_date>
  <modified_user>-</modified_user>
  <modified_date>2017&#x2f;08&#x2f;08 14&#x3a;56&#x3a;30.436</modified_date>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>BI</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>BI_DLDF_TEST</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS_DLDF_TEST</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>BI_TEST</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>QMYS_TEST</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>BI_TEST_115</name>
    <server>10.1.65.115</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS_JS_Bonus</database>
    <port>1435</port>
    <username>admin</username>
    <password>Encrypted 2be98afc86aa7f285af14a77e8cc2fe82</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1435</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>BI_TEST_BI3</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>BPM</name>
    <server>10.1.16.158</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>shangye</database>
    <port>1521</port>
    <username>sgbpm_sgbi</username>
    <password>Encrypted 2be98afc839c0a081aa1dab628cc2fe8d</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>DLDF</name>
    <server>10.1.16.122</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>BI_DATA_DLDF_TEST</database>
    <port>1433</port>
    <username>bi</username>
    <password>Encrypted 2be98afc86aa7f2e4bb39bd63c9c2bdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>dldf_s</name>
    <server>10.1.16.177</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>MI_NET_HSZJ</database>
    <port>1433</port>
    <username>dldf_ro</username>
    <password>Encrypted 2be98afc80ecb9682b916ed228ec3f799</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>dw_dldf</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS_MI_NET_HSZJ</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>dw_hs</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>EAS</name>
    <server>10.1.0.135</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>hseasdb1</database>
    <port>1521</port>
    <username>hseas_bireader</username>
    <password>Encrypted 2be98afc828cea081aa1dab628cc2fe8d</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>HER</name>
    <server>10.1.16.31</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>UserDB</database>
    <port>1433</port>
    <username>usr_bihs_r</username>
    <password>Encrypted 2be98afc86aa7f2e4a910a6639fa38ee0</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>HN</name>
    <server>10.16.1.3</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>IPVA_S0400_B3</database>
    <port>1433</port>
    <username>hsjt&#x40;P1</username>
    <password>Encrypted 2be98afc802d498908b0cbd75ccc1fd8b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MSSQL.instance</code><attribute>IPVA</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>HS</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>HS_BI_TO_KSH</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS_BI_TO_KSH</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>HS_KSH</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS_KSH</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>JS_BONUS</name>
    <server>10.1.65.115</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>HS_JS_BONUS</database>
    <port>1435</port>
    <username>admin</username>
    <password>Encrypted 2be98afc86aa7f285af14a77e8cc2fe82</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1435</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>MY</name>
    <server>10.1.16.125</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>dotnet_erp351SP3</database>
    <port>1433</port>
    <username>mysoft</username>
    <password>Encrypted 2be98afc86aea8b97a41fba298bcbfc82</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>nc61</name>
    <server>10.1.18.154</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>ncrac11</database>
    <port>1521</port>
    <username>BI_SG</username>
    <password>Encrypted 2be98afc808cead96ae18aa75ccb2bcdd</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>PM</name>
    <server>10.1.16.97</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>CB_HS</database>
    <port>1433</port>
    <username>bi</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ac79d681acd8</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>PM_ZJ</name>
    <server>10.1.18.94</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>CB_ZJ</database>
    <port>1433</port>
    <username>bi</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ac79d681acd8</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>QMYS_HS</name>
    <server>10.1.19.197</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>lsdb1</database>
    <port>1521</port>
    <username>hssgbireader </username>
    <password>Encrypted 2bef0dcbb0dc59b96ae18aa75ccc2fe8a</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>QMYS_ZJ</name>
    <server>10.1.19.197</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>zjlsdb1</database>
    <port>1521</port>
    <username>sgbireader </username>
    <password>Encrypted 2be98afbb0dc59b96ae18aa75ccc2fe8a</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>XHD</name>
    <server>10.1.19.197</server>
    <type>ORACLE</type>
    <access>Native</access>
    <database>zjlsdb1</database>
    <port>1521</port>
    <username>zj_sgbi</username>
    <password>Encrypted 2be98afc86aa7888eb81eac798cc2fe8d</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1521</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>XR_TO_BI</name>
    <server>10.16.1.249</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>XR_TO_BI</database>
    <port>1433</port>
    <username>sa</username>
    <password>Encrypted 2be98afc86aa7f2b4aa0abd50c99dbdde</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>1433</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <order>
  <hop> <from>ODS_to_BI</from><to>&#x8868;&#x8f93;&#x51fa; YW_HS_ROOM_MANAGEMENT</to><enabled>Y</enabled> </hop>
  <hop> <from>&#x6e05;&#x9664;  YW_HS_ROOM_MANAGEMENT </from><to>ODS_to_BI</to><enabled>Y</enabled> </hop>
  <hop> <from>&#x6e05;&#x9664;  YW_HS_OWE</from><to>ODS_to_YW_HS_OWE</to><enabled>Y</enabled> </hop>
  <hop> <from>ODS_to_YW_HS_OWE</from><to>YW_HS_OWE &#x8868;&#x8f93;&#x51fa;</to><enabled>Y</enabled> </hop>
  <hop> <from>ODS_to_YW_HS_PJFJ_XR_TEST</from><to>YW_HS_PJFJ_XR_TEST &#x63d2;&#x5165; &#x2f; &#x66f4;&#x65b0;</to><enabled>Y</enabled> </hop>
  <hop> <from>ODS_to_YW_HS_KYJG2_XR_TEST</from><to>YW_HS_KYJG2_XR_TEST &#x63d2;&#x5165; &#x2f; &#x66f4;&#x65b0;</to><enabled>Y</enabled> </hop>
  </order>
  <step>
    <name>ODS_to_BI</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <sql>with market_dim as &#x28;&#xd;&#xa;select&#xd;&#xa;	market_class_code,--&#x6307;&#x6807;&#x7c7b;&#x7f16;&#x7801;&#xd;&#xa;	market_class_name,--&#x6307;&#x6807;&#x5927;&#x7c7b;&#xd;&#xa;	market_detail_code,&#xd;&#xa;	market_detail_name,&#xd;&#xa;	yjourrep_class,--&#x7c7b;&#x63cf;&#x8ff0;&#x7f16;&#x7801;&#xd;&#xa;	yjourrep_class_name--&#x7c7b;&#x63cf;&#x8ff0;&#xd;&#xa;from YW_HS_DIM_YJOURREP_CLASS --&#x7ef4;&#x8868;-&#x5e02;&#x573a;&#x7ec6;&#x5206;&#x7ef4;&#x5ea6;&#x8868;&#xd;&#xa;&#xd;&#xa;&#x29;,&#xd;&#xa;room_act AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	yjourrep_class,--&#x7ecf;&#x8425;&#x65e5;&#x62a5;&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month, --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	SUM&#x28;rental_number&#x29; AS sale_act -- &#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x5b9e;&#x9645;&#xd;&#xa;FROM ODS_XR_ROOM_RENTAL_NUMBER &#xd;&#xa;--WHERE convert&#x28;varchar&#x28;7&#x29;,bdate,23&#x29;&#x3d;convert&#x28;varchar&#x28;7&#x29;,dateadd&#x28;day,-9,getdate&#x28;&#x29;&#x29;,23&#x29;&#xd;&#xa;GROUP BY&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	yjourrep_class,--&#x7c7b;&#x63cf;&#x8ff0;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29;,&#xd;&#xa;	month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;bud as &#x28;&#xd;&#xa;select&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	yjourrep_class,--&#x7ecf;&#x8425;&#x65e5;&#x62a5;&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	sum&#x28;room_sale_amount&#x29; as sale_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;	sum&#x28;room_sales&#x29; as income_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6536;&#x5165;&#x9884;&#x7b97;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;from ODS_XR_BENEFIT_ANALYST_BUD --&#x4e8b;&#x5b9e;&#x8868;-&#x5ba2;&#x623f;&#x7ecf;&#x8425;&#x9884;&#x7b97;&#x8868;&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;7&#x29;,bdate,23&#x29;&#x3d;convert&#x28;varchar&#x28;7&#x29;,dateadd&#x28;day,-9,getdate&#x28;&#x29;&#x29;,23&#x29;&#xd;&#xa;GROUP BY&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	yjourrep_class,--&#x7c7b;&#x63cf;&#x8ff0;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; ,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29;  --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;act as &#x28;&#xd;&#xa;select&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	yjourrep_class,--&#x7ecf;&#x8425;&#x65e5;&#x62a5;&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;audit_time&#x29; as year, --&#x5165;&#x8d26;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;audit_time&#x29; as month, --&#x5165;&#x8d26;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	&#xd;&#xa;	sum&#x28;actul_price&#x29; as income_act --&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;from ODS_XR_BENEFIT_ANALYST_ACT --&#x4e8b;&#x5b9e;&#x8868;-&#x5ba2;&#x623f;&#x7ecf;&#x8425;&#x5b9e;&#x9645;&#x8868;&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;7&#x29;,audit_time,23&#x29;&#x3d;convert&#x28;varchar&#x28;7&#x29;,dateadd&#x28;day,-9,getdate&#x28;&#x29;&#x29;,23&#x29;&#xd;&#xa;WHERE pccode_deptno_name&#x3d;&#x27;&#x5ba2;&#x623f;&#x27;&#xd;&#xa;AND roomfee_type&#x3d;&#x27;rm&#x27;&#xd;&#xa;AND pccode_name &#x3c;&#x3e; &#x27;&#x5ba2;&#x623f;&#x5176;&#x4ed6;&#x27;&#xd;&#xa;group by project_code,&#xd;&#xa;	yjourrep_class,&#xd;&#xa;	year&#x28;audit_time&#x29;,&#xd;&#xa;	month&#x28;audit_time&#x29;&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;	e.project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801; --&#x6620;&#x5c04;&#x8868;&#x8865;&#x5168;&#xd;&#xa;	--a.project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	c.year,--&#x7edf;&#x8ba1;&#x5e74;&#xd;&#xa;	c.month,--&#x7edf;&#x8ba1;&#x6708;&#xd;&#xa;	a.market_class_code,&#xd;&#xa;	a.market_class_name,&#xd;&#xa;	a.market_detail_code,--&#x6307;&#x6807;&#x7c7b;&#x7f16;&#x7801;&#xd;&#xa;	a.market_detail_name,--&#x6307;&#x6807;&#x7c7b;&#x540d;&#x79f0;&#xd;&#xa;	round&#x28;sum&#x28;isnull&#x28;c.sale_bud,0&#x29;&#x29;,0&#x29; as sale_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;	sum&#x28;isnull&#x28;c.income_bud,0&#x29;&#x29;as income_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6536;&#x5165;&#x9884;&#x7b97;&#xd;&#xa;	round&#x28;sum&#x28;isnull&#x28;q.sale_act,0&#x29;&#x29;,0&#x29; as sale_act,--&#x7edf;&#x8ba1;&#x8d26;&#x5355;&#x6570;&#xff08;&#x4e00;&#x4e2a;&#x8d26;&#x5355;&#x7f16;&#x7801;&#x4e3a;&#x9500;&#x552e;&#x5355;&#xff09;&#xd;&#xa;	sum&#x28;isnull&#x28;d.income_act,0&#x29;&#x29; as income_act,--&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;	round&#x28;sum&#x28;isnull&#x28;z.sale_act,0&#x29;&#x29;,0&#x29; as sale_last,--&#x7edf;&#x8ba1;&#x8d26;&#x5355;&#x6570;&#xff08;&#x4e00;&#x4e2a;&#x8d26;&#x5355;&#x7f16;&#x7801;&#x4e3a;&#x9500;&#x552e;&#x5355;&#xff09;&#xd;&#xa;	sum&#x28;isnull&#x28;f.income_act,0&#x29;&#x29; as income_last,--&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;	getdate&#x28;&#x29; AS timestamp&#xd;&#xa;from market_dim a&#xd;&#xa;left join bud c on a.yjourrep_class&#x3d;c.yjourrep_class&#xd;&#xa;left join act d on c.project_code&#x3d;d.project_code and c.year&#x3d;d.year and c.month&#x3d;d.month and a.yjourrep_class&#x3d;d.yjourrep_class&#xd;&#xa;left join room_act q on c.project_code&#x3d;q.project_code and c.year&#x3d;q.year and c.month&#x3d;q.month and a.yjourrep_class&#x3d;q.yjourrep_class&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP e ON c.project_code &#x3d;e.projectcode&#xd;&#xa;left join act f on c.project_code&#x3d;f.project_code and c.year&#x3d;f.year&#x2b;1 and c.month&#x3d;f.month and a.yjourrep_class&#x3d;f.yjourrep_class&#xd;&#xa;left join room_act z on c.project_code&#x3d;z.project_code and c.year&#x3d;z.year&#x2b;1 and c.month&#x3d;z.month and a.yjourrep_class&#x3d;z.yjourrep_class&#xd;&#xa;&#xd;&#xa;where e.project_code is not null &#xd;&#xa;---&#x53ea;&#x66f4;&#x65b0;19&#x5e74;5&#x6708;&#x53ca;&#x4ee5;&#x540e;&#x7684;&#x6570;&#x636e;&#xd;&#xa;--and &#x28;&#x28;c.year&#x3d; 2019 and c.month&#x3e;&#x3d;5&#x29; or c.year&#x3e;2019&#x29;&#xd;&#xa;group by e.project_code,c.year,c.month,a.market_class_code,a.market_class_name,a.market_detail_code,a.market_detail_name</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>317</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>ODS_to_YW_HS_KYJG2_XR_TEST</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <sql>WITH sj_dim_sj AS&#x28;&#xd;&#xa;SELECT DISTINCT project_code, CONVERT&#x28;VARCHAR&#x28;10&#x29;,bdate,23&#x29; as the_date&#xd;&#xa;FROM ODS_XR_ROOM_BASEINFO &#xd;&#xa;&#x29;,&#xd;&#xa; num_dim_sj  AS&#x28;&#xd;&#xa;SELECT project_code,the_date, row_number&#x28;&#x29; over &#x28;partition by project_code order by the_date&#x29; AS num FROM sj_dim_sj &#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa; start_dim_sj AS&#x28;&#xd;&#xa;SELECT project_code,the_date AS start_date FROM num_dim_sj WHERE num&#x3d;1&#xd;&#xa;&#x29;,&#xd;&#xa; tsac_dim_sj AS&#x28;&#xd;&#xa;SELECT project_code,CONVERT&#x28;VARCHAR&#x28;7&#x29;,the_date,23&#x29; AS yearmonth,YEAR&#x28;the_date&#x29; AS year,MONTH&#x28;the_date&#x29; AS month,COUNT&#x28;the_date&#x29;  AS tsac&#xd;&#xa;FROM sj_dim_sj&#xd;&#xa;GROUP BY project_code,CONVERT&#x28;VARCHAR&#x28;7&#x29;,the_date,23&#x29;,YEAR&#x28;the_date&#x29;,MONTH&#x28;the_date&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;dim_sj AS&#x28;&#xd;&#xa;SELECT a.project_code,a.year,a.month,a.tsac,&#xd;&#xa;&#xd;&#xa;		CASE WHEN year&#x28;a.yearmonth&#x2b;&#x27;-01&#x27;&#x29;&#x3d;YEAR&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29; THEN &#x28;&#xd;&#xa;				CASE WHEN month&#x28;a.yearmonth&#x2b;&#x27;-01&#x27;&#x29;&#x3d;month&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29; THEN&#xd;&#xa;				DATEDIFF&#x28;day,b.start_date , convert&#x28;varchar&#x28;10&#x29;,DATEADD&#x28;day, -1,GETDATE&#x28;&#x29; &#x29;,23&#x29;&#x29;&#xd;&#xa;				ELSE &#x28;CASE WHEN year&#x28;b.start_date&#x29;&#x3d;YEAR&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29; THEN DATEDIFF&#x28;day,b.start_date , DATEADD&#x28;month, 1,a.yearmonth&#x2b;&#x27;-01&#x27; &#x29;&#x29;&#xd;&#xa;				ELSE DATEDIFF&#x28;day,convert&#x28;varchar&#x28;4&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01-01&#x27; , DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29; END&#x29; END  &#x29;&#xd;&#xa;				ELSE DATEDIFF&#x28;day,convert&#x28;varchar&#x28;4&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01-01&#x27; , DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29; END AS tyac,&#xd;&#xa;		CASE WHEN YEAR&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29;-1&#x3e;YEAR&#x28;b.start_date&#x29; THEN DATEDIFF&#x28;day,DATEADD&#x28;year,-1,convert&#x28;varchar&#x28;4&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01-01&#x27;&#x29; , DATEADD&#x28;year,-1,DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29;&#x29; ELSE &#xd;&#xa;				CASE WHEN  YEAR&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29;-1&#x3d;YEAR&#x28;b.start_date&#x29;  THEN DATEDIFF&#x28;day,b.start_date , DATEADD&#x28;year,-1,DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,a.yearmonth&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29;&#x29; ELSE 0 END&#xd;&#xa;		END	as ly&#xd;&#xa;FROM tsac_dim_sj a&#xd;&#xa;LEFT JOIN start_dim_sj b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;&#x29;,--&#x65f6;&#x95f4;&#x7ef4;&#x5ea6;&#xd;&#xa;&#xd;&#xa;sum_room as&#x28;&#xd;&#xa;select&#xd;&#xa;	project_code, --&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x9879;&#x76ee;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month,--&#x9879;&#x76ee;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	count&#x28;roomid&#x29; as roomcount --&#x623f;&#x95f4;&#x6570;&#xd;&#xa;from ODS_XR_ROOM_BASEINFO --&#x7ef4;&#x8868;-&#x623f;&#x95f4;&#x4fe1;&#x606f;&#x7ef4;&#x5ea6;&#x8868;&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;10&#x29;,&#x5b;timestamp&#x5d;,23&#x29;&#x3d;&#x27;2017-10-25&#x27;&#xd;&#xa;WHERE DAY&#x28;bdate&#x29;&#x3d;&#x27;1&#x27;&#xd;&#xa;group by project_code,&#xd;&#xa;	year&#x28;bdate&#x29;,&#xd;&#xa;	month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;--&#x7d2f;&#x8ba1;&#x5355;&#x6708;&#x603b;&#x623f;&#x95f4;&#x6570;&#xd;&#xa;&#xd;&#xa;room_act AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month, --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	SUM&#x28;rental_number&#x29; AS sale_act -- &#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x5b9e;&#x9645;&#xd;&#xa;FROM ODS_XR_ROOM_RENTAL_NUMBER a&#xd;&#xa;LEFT JOIN YW_HS_DIM_YJOURREP_CLASS b&#xd;&#xa;ON a.yjourrep_class&#x3d;b.yjourrep_class&#xd;&#xa;WHERE b.yjourrep_class is not null&#xd;&#xa;GROUP BY&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29;,&#xd;&#xa;	month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;pjfj_ys as &#x28;&#xd;&#xa;select&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month, --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	cast&#x28;year&#x28;bdate&#x29;as varchar&#x28;20&#x29;&#x29;&#x2b;&#x27;&#x9884;&#x7b97;&#x27; as subject_name, &#xd;&#xa;	sum&#x28;room_sale_amount&#x29; as sale_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;	sum&#x28;room_sales&#x29; AS income_bud --&#x9500;&#x552e;&#x623f;&#x95f4;&#x6536;&#x5165;&#x9884;&#x7b97;&#xd;&#xa;from ODS_XR_BENEFIT_ANALYST_BUD --&#x4e8b;&#x5b9e;&#x8868;-&#x5ba2;&#x623f;&#x7ecf;&#x8425;&#x9884;&#x7b97;&#x8868;&#xd;&#xa;a&#xd;&#xa;LEFT JOIN YW_HS_DIM_YJOURREP_CLASS b&#xd;&#xa;ON a.yjourrep_class&#x3d;b.yjourrep_class&#xd;&#xa;WHERE b.yjourrep_class is not null&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;10&#x29;,&#x5b;timestamp&#x5d;,23&#x29;&#x3d;&#x27;2017-10-25&#x27;&#xd;&#xa;GROUP BY project_code,year&#x28;bdate&#x29;,month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,--&#x9884;&#x7b97;&#xd;&#xa;&#xd;&#xa;sale_act AS&#x28;&#xd;&#xa;select&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;audit_time&#x29; as year, --&#x5165;&#x8d26;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;audit_time&#x29; as month, --&#x5165;&#x8d26;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;  cast&#x28;year&#x28;audit_time&#x29; as varchar&#x28;20&#x29;&#x29;&#x2b;&#x27;&#x5b9e;&#x9645;&#x27; as subject_name, &#xd;&#xa;	sum&#x28;actul_price&#x29; as income_act --&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;from ODS_XR_BENEFIT_ANALYST_ACT --&#x4e8b;&#x5b9e;&#x8868;-&#x5ba2;&#x623f;&#x7ecf;&#x8425;&#x5b9e;&#x9645;&#x8868;&#xd;&#xa;a&#xd;&#xa;LEFT JOIN YW_HS_DIM_YJOURREP_CLASS b&#xd;&#xa;ON a.yjourrep_class&#x3d;b.yjourrep_class&#xd;&#xa;WHERE b.yjourrep_class is not null&#xd;&#xa;and pccode_deptno_name&#x3d;&#x27;&#x5ba2;&#x623f;&#x27;&#xd;&#xa;AND roomfee_type&#x3d;&#x27;rm&#x27;&#xd;&#xa;AND pccode_name &#x3c;&#x3e; &#x27;&#x5ba2;&#x623f;&#x5176;&#x4ed6;&#x27;&#xd;&#xa;--AND roomfee_type&#x3d;&#x27;&#x27;&#xd;&#xa;----------&#xd;&#xa;----------&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;10&#x29;,&#x5b;timestamp&#x5d;,23&#x29;&#x3d;&#x27;2017-10-25&#x27;&#xd;&#xa;group by project_code,&#xd;&#xa;	b.yjourrep_class,&#xd;&#xa;	year&#x28;audit_time&#x29;,&#xd;&#xa;	month&#x28;audit_time&#x29;&#xd;&#xa;&#x29;,--&#x7edf;&#x8ba1;&#x8d26;&#xd;&#xa;&#xd;&#xa;pjfj_sj as &#x28;&#xd;&#xa;SELECT&#xd;&#xa;       project_code,&#xd;&#xa;       year,&#xd;&#xa;       month,&#xd;&#xa;			 subject_name, &#xd;&#xa;			 SUM&#x28;income_act&#x29; AS income_act&#xd;&#xa;FROM sale_act&#xd;&#xa;GROUP BY &#xd;&#xa;	     project_code,&#xd;&#xa;       year,&#xd;&#xa;       month,&#xd;&#xa;			 subject_name&#xd;&#xa;&#x29;,--&#x5b9e;&#x9645;&#xd;&#xa;&#xd;&#xa;pjfj_period_bud AS&#x28;&#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;SUM&#x28;b.sale_bud&#x29; AS sale_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;SUM&#x28;b.income_bud&#x29; AS income_bud --&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;FROM pjfj_ys a&#xd;&#xa;LEFT JOIN pjfj_ys b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;GROUP BY&#xd;&#xa;	a.project_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;period_sale_act AS&#x28;&#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;SUM&#x28;q.sale_act&#x29; AS sale_act--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;FROM pjfj_sj a&#xd;&#xa;LEFT JOIN room_act q&#xd;&#xa;ON a.project_code&#x3d;q.project_code&#xd;&#xa;AND a.year&#x3d;q.year&#xd;&#xa;AND a.month&#x3e;&#x3d;q.month&#xd;&#xa;GROUP BY&#xd;&#xa;	a.project_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;period_income_act AS&#x28;&#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;SUM&#x28;b.income_act&#x29; AS income_act --&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;FROM pjfj_sj a&#xd;&#xa;LEFT JOIN pjfj_sj b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;GROUP BY&#xd;&#xa;	a.project_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;pjfj_period_act AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;a.sale_act,&#xd;&#xa;b.income_act&#xd;&#xa;FROM period_sale_act a&#xd;&#xa;LEFT JOIN period_income_act b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;last_period_sale_act AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;SUM&#x28;q.sale_act&#x29; AS sale_act--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;FROM pjfj_sj a&#xd;&#xa;LEFT JOIN room_act q&#xd;&#xa;ON a.project_code&#x3d;q.project_code&#xd;&#xa;AND a.year-1&#x3d;q.year&#xd;&#xa;AND a.month&#x3e;&#x3d;q.month&#xd;&#xa;GROUP BY&#xd;&#xa;	a.project_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;last_period_income_act AS &#x28;&#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;SUM&#x28;b.income_act&#x29; AS income_act --&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;FROM pjfj_sj a&#xd;&#xa;LEFT JOIN pjfj_sj b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year-1&#x3d;b.year&#xd;&#xa;AND a.month&#x3e;&#x3d;b.month&#xd;&#xa;GROUP BY&#xd;&#xa;	a.project_code,&#xd;&#xa;	a.year,&#xd;&#xa;	a.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;pjfj_last_period_act AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;a.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;a.sale_act,&#xd;&#xa;b.income_act&#xd;&#xa;FROM last_period_sale_act a&#xd;&#xa;LEFT JOIN last_period_income_act b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;subject_month AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;c.project_code,&#xd;&#xa;&#x27;1020&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xff08;&#x5143;&#xff09;&#x27; AS subject_name,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;case WHEN isnull&#x28;a.sale_bud,0&#x29; &#x3d; 0 THEN NULL ELSE a.income_bud&#x2f;a.sale_bud END  as month_bud,--&#x9884;&#x7b97;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;case WHEN isnull&#x28;q.sale_act,0&#x29; &#x3d; 0 THEN NULL ELSE b.income_act&#x2f;q.sale_act END  as month_act --&#x5b9e;&#x9645;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;FROM pjfj_ys  a&#xd;&#xa;LEFT JOIN pjfj_sj  b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;LEFT JOIN room_act q&#xd;&#xa;ON a.project_code&#x3d;q.project_code&#xd;&#xa;AND a.year&#x3d;q.year&#xd;&#xa;AND a.month&#x3d;q.month&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP c ON a.project_code &#x3d;c.projectcode&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;			e.project_code,&#xd;&#xa;			&#x27;1010&#x27; AS subject_code,&#xd;&#xa;			&#x27;&#x5165;&#x4f4f;&#x7387;&#xff08;&#x25;&#xff09;&#x27; AS subject_name,&#xd;&#xa;      a.year,&#xd;&#xa;			a.month,&#xd;&#xa;      cast&#x28;a.sale_bud as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.tsac&#x29; as month_bud,&#xd;&#xa;			cast&#x28;q.sale_act as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.tsac&#x29; as month_act&#xd;&#xa;from pjfj_ys a&#xd;&#xa;left join pjfj_sj b on a.project_code&#x3d;b.project_code and a.year&#x3d;b.year and a.month&#x3d;b.month&#xd;&#xa;left join room_act q on a.project_code&#x3d;q.project_code and a.year&#x3d;q.year and a.month&#x3d;q.month&#xd;&#xa;LEFT JOIN sum_room c ON a.project_code&#x3d;c.project_code and a.year&#x3d;c.year and a.month&#x3d;c.month&#xd;&#xa;LEFT JOIN dim_sj d ON  a.project_code&#x3d;d.project_code and a.year&#x3d;d.year AND a.month&#x3d;d.month&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP e ON a.project_code &#x3d;e.projectcode&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;subject_period AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;c.project_code,&#xd;&#xa;&#x27;1020&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xff08;&#x5143;&#xff09;&#x27; AS subject_name,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;case WHEN isnull&#x28;sale_bud,0&#x29; &#x3d; 0 THEN NULL ELSE income_bud&#x2f;sale_bud END  as period_bud,--&#x9884;&#x7b97;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;case WHEN isnull&#x28;sale_act,0&#x29; &#x3d; 0 THEN NULL ELSE income_act&#x2f;sale_act END  as period_act --&#x5b9e;&#x9645;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;FROM pjfj_period_bud  a&#xd;&#xa;LEFT JOIN pjfj_period_act  b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP c ON a.project_code &#x3d;c.projectcode&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;			e.project_code,&#xd;&#xa;			&#x27;1010&#x27; AS subject_code,&#xd;&#xa;			&#x27;&#x5165;&#x4f4f;&#x7387;&#xff08;&#x25;&#xff09;&#x27; AS subject_name,&#xd;&#xa;      a.year,&#xd;&#xa;			a.month,&#xd;&#xa;      cast&#x28;a.sale_bud as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.tyac&#x29; as period_bud,&#xd;&#xa;			cast&#x28;b.sale_act as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.tyac&#x29; as period_act&#xd;&#xa;FROM pjfj_period_bud  a&#xd;&#xa;LEFT JOIN pjfj_period_act  b on a.project_code&#x3d;b.project_code and a.year&#x3d;b.year and a.month&#x3d;b.month&#xd;&#xa;LEFT JOIN sum_room c ON a.project_code&#x3d;c.project_code and a.year&#x3d;c.year and a.month&#x3d;c.month&#xd;&#xa;LEFT JOIN dim_sj d ON a.project_code&#x3d;d.project_code AND a.year&#x3d;d.year AND a.month&#x3d;d.month&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP e ON a.project_code &#x3d;e.projectcode&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;subject_last AS &#x28;&#xd;&#xa;SELECT &#xd;&#xa;c.project_code,&#xd;&#xa;&#x27;1020&#x27; AS subject_code,&#xd;&#xa;&#x27;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xff08;&#x5143;&#xff09;&#x27; AS subject_name,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;case WHEN isnull&#x28;sale_act,0&#x29; &#x3d; 0 THEN NULL ELSE income_act&#x2f;sale_act END  as last_act --&#x5b9e;&#x9645;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;FROM pjfj_last_period_act a&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP c ON a.project_code &#x3d;c.projectcode&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;			e.project_code,&#xd;&#xa;			&#x27;1010&#x27; AS subject_code,&#xd;&#xa;			&#x27;&#x5165;&#x4f4f;&#x7387;&#xff08;&#x25;&#xff09;&#x27; AS subject_name,&#xd;&#xa;      a.year,&#xd;&#xa;			a.month,&#xd;&#xa;			cast&#x28;a.sale_act as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.ly&#x29; as last_act&#xd;&#xa;FROM pjfj_last_period_act  a &#xd;&#xa;LEFT JOIN sum_room c ON a.project_code&#x3d;c.project_code and a.year&#x3d;c.year and a.month&#x3d;c.month&#xd;&#xa;LEFT JOIN dim_sj d ON a.project_code&#x3d;d.project_code AND a.year&#x3d;d.year AND a.month&#x3d;d.month&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP e ON a.project_code &#x3d;e.projectcode&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;VALUES_PJFJ AS&#x28;&#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;a.subject_code,&#xd;&#xa;a.subject_name,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;a.month_bud,&#xd;&#xa;a.month_act,&#xd;&#xa;b.period_bud,&#xd;&#xa;b.period_act,&#xd;&#xa;c.last_act AS last_period_act&#xd;&#xa;FROM subject_month a&#xd;&#xa;LEFT JOIN subject_period b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.subject_code&#x3d;b.subject_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;LEFT JOIN subject_last c&#xd;&#xa;ON a.project_code&#x3d;c.project_code&#xd;&#xa;AND a.subject_code&#x3d;c.subject_code&#xd;&#xa;AND a.year&#x3d;c.year&#xd;&#xa;AND a.month&#x3d;c.month&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;PJFJ AS&#x28;&#xd;&#xa;SELECT &#x2a; FROM VALUES_PJFJ WHERE subject_code&#x3d;&#x27;1010&#x27;&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;RZL AS&#x28;&#xd;&#xa;SELECT &#x2a; FROM VALUES_PJFJ WHERE subject_code&#x3d;&#x27;1020&#x27;&#xd;&#xa;&#x29;&#xd;&#xa;&#xd;&#xa;SELECT &#x2a; FROM VALUES_PJFJ where project_code is not null&#xd;&#xa;---&#x53ea;&#x66f4;&#x65b0;19&#x5e74;5&#x6708;&#x53ca;&#x4ee5;&#x540e;&#x7684;&#x6570;&#x636e;&#xd;&#xa;--and &#x28;&#x28;year&#x3d; 2019 and month&#x3e;&#x3d;5&#x29; or year&#x3e;2019&#x29;&#xd;&#xa;&#xd;&#xa;UNION ALL &#xd;&#xa;SELECT&#xd;&#xa;a.project_code,&#xd;&#xa;&#x27;1030&#x27; AS subject_code,&#xd;&#xa;&#x27;RevPar&#xff08;&#x5143;&#xff09;&#x27; AS subject_name,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;a.month_bud&#x2a;b.month_bud AS month_bud,&#xd;&#xa;a.month_act&#x2a;b.month_act AS month_act,&#xd;&#xa;a.period_bud&#x2a;b.period_bud AS period_bud,&#xd;&#xa;a.period_act&#x2a;b.period_act AS period_act,&#xd;&#xa;a.last_period_act&#x2a;b.last_period_act AS last_period_act&#xd;&#xa;FROM PJFJ a&#xd;&#xa;LEFT JOIN RZL b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;&#xd;&#xa;where a.project_code is not null&#xd;&#xa;---&#x53ea;&#x66f4;&#x65b0;19&#x5e74;5&#x6708;&#x53ca;&#x4ee5;&#x540e;&#x7684;&#x6570;&#x636e;&#xd;&#xa;--and &#x28;&#x28;a.year&#x3d; 2019 and a.month&#x3e;&#x3d;5&#x29; or a.year&#x3e;2019&#x29;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>324</xloc>
      <yloc>535</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>ODS_to_YW_HS_OWE</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <sql>SELECT&#xd;&#xa;c.project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;a.debt_company,--&#x516c;&#x53f8;&#xd;&#xa;a.debt_class,--&#x503a;&#x52a1;&#x7c7b;&#x578b;&#xd;&#xa;CASE WHEN b.company_name IS NULL then &#x27;0&#x27; ELSE &#x27;1&#x27; END AS is_related,--&#x5173;&#x8054;&#x516c;&#x53f8;&#x6807;&#x8bc6;&#xd;&#xa;null lease_area,--&#x79df;&#x8d41;&#x9762;&#x79ef;&#xd;&#xa;NULL deposit,--&#x5b58;&#x6b3e;&#xd;&#xa;NULL status,--&#x72b6;&#x6001;&#xd;&#xa;invperiod,--&#x6743;&#x8d23;&#x622a;&#x81f3;&#x6708;&#xd;&#xa;invdate, --&#x6838;&#x9500;&#x65f6;&#x95f4;&#xd;&#xa;invamount, --&#x6b20;&#x6b3e;&#xd;&#xa;owedays --&#x5f20;&#x73b2;&#x5929;&#x6570;&#xd;&#xa;FROM ODS_XR_OWE a&#xd;&#xa;LEFT JOIN YW_YY_RELATEDCOMPANY b&#xd;&#xa;ON a.debt_company&#x3d;b.company_name&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP c&#xd;&#xa;ON a.project_code&#x3d;c.projectcode&#xd;&#xa;where c.project_code is not null</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>322</xloc>
      <yloc>332</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>ODS_to_YW_HS_PJFJ_XR_TEST</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <sql>with dim_sj as&#x28;&#xd;&#xa;select &#xd;&#xa;		distinct year&#x28;the_date&#x29; as year,&#xd;&#xa;		month&#x28;the_date&#x29; as month,&#xd;&#xa;    DATEDIFF&#x28;day,convert&#x28;varchar&#x28;7&#x29;,the_date&#x29;&#x2b;&#x27;-01&#x27; , DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,the_date&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29;	as tsbu,&#xd;&#xa;		CASE WHEN year&#x28;the_date&#x29;&#x3d;YEAR&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29; THEN &#x28;&#xd;&#xa;				CASE WHEN month&#x28;the_date&#x29;&#x3d;month&#x28;DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;&#x29; THEN&#xd;&#xa;				DATEDIFF&#x28;day,convert&#x28;varchar&#x28;7&#x29;,DATEADD&#x28;day,-1,GETDATE&#x28;&#x29;&#x29;,23&#x29;&#x2b;&#x27;-01&#x27; , convert&#x28;varchar&#x28;10&#x29;,GETDATE&#x28;&#x29;,23&#x29;&#x29;&#xd;&#xa;				ELSE DATEDIFF&#x28;day,convert&#x28;varchar&#x28;7&#x29;,the_date&#x29;&#x2b;&#x27;-01&#x27; , DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,the_date&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29; END  &#x29;&#xd;&#xa;		ELSE DATEDIFF&#x28;day,convert&#x28;varchar&#x28;7&#x29;,the_date&#x29;&#x2b;&#x27;-01&#x27; , DATEADD&#x28;month, 1,convert&#x28;varchar&#x28;7&#x29;,the_date&#x29;&#x2b;&#x27;-01&#x27; &#x29;&#x29; END AS tsac&#xd;&#xa;from  Dim_time&#xd;&#xa;where the_year &#x3c;&#x3d;&#x27;2050&#x27; AND the_year &#x3e;&#x3d;&#x27;2000&#x27;&#xd;&#xa;&#x29;,--&#x65f6;&#x95f4;&#x7ef4;&#x5ea6;&#xd;&#xa;&#xd;&#xa;sum_room as&#x28;&#xd;&#xa;select&#xd;&#xa;	project_code, --&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x9879;&#x76ee;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month,--&#x9879;&#x76ee;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	count&#x28;roomid&#x29; as roomcount --&#x623f;&#x95f4;&#x6570;&#xd;&#xa;from ODS_XR_ROOM_BASEINFO --&#x7ef4;&#x8868;-&#x623f;&#x95f4;&#x4fe1;&#x606f;&#x7ef4;&#x5ea6;&#x8868;&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;10&#x29;,&#x5b;timestamp&#x5d;,23&#x29;&#x3d;&#x27;2017-10-25&#x27;&#xd;&#xa;WHERE DAY&#x28;bdate&#x29;&#x3d;&#x27;1&#x27;&#xd;&#xa;group by project_code,&#xd;&#xa;	year&#x28;bdate&#x29;,&#xd;&#xa;	month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;--&#x7d2f;&#x8ba1;&#x5355;&#x6708;&#x603b;&#x623f;&#x95f4;&#x6570;&#xd;&#xa;&#xd;&#xa;room_act AS&#x28;&#xd;&#xa;SELECT &#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month, --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	SUM&#x28;rental_number&#x29; AS sale_act -- &#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x5b9e;&#x9645;&#xd;&#xa;FROM ODS_XR_ROOM_RENTAL_NUMBER a&#xd;&#xa;LEFT JOIN YW_HS_DIM_YJOURREP_CLASS b&#xd;&#xa;ON a.yjourrep_class&#x3d;b.yjourrep_class&#xd;&#xa;WHERE b.yjourrep_class is not null&#xd;&#xa;GROUP BY&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29;,&#xd;&#xa;	month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,&#xd;&#xa;&#xd;&#xa;pjfj_ys as &#x28;&#xd;&#xa;select&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;bdate&#x29; as year,--&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;bdate&#x29; as month, --&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;	cast&#x28;year&#x28;bdate&#x29;as varchar&#x28;20&#x29;&#x29;&#x2b;&#x27;&#x9884;&#x7b97;&#x27; as subject_name, &#xd;&#xa;	sum&#x28;room_sale_amount&#x29; as sale_bud,--&#x9500;&#x552e;&#x623f;&#x95f4;&#x6570;&#x9884;&#x7b97;&#xd;&#xa;	sum&#x28;room_sales&#x29; AS income_bud --&#x9500;&#x552e;&#x623f;&#x95f4;&#x6536;&#x5165;&#x9884;&#x7b97;&#xd;&#xa;from ODS_XR_BENEFIT_ANALYST_BUD --&#x4e8b;&#x5b9e;&#x8868;-&#x5ba2;&#x623f;&#x7ecf;&#x8425;&#x9884;&#x7b97;&#x8868;&#xd;&#xa;a&#xd;&#xa;LEFT JOIN YW_HS_DIM_YJOURREP_CLASS b&#xd;&#xa;ON a.yjourrep_class&#x3d;b.yjourrep_class&#xd;&#xa;WHERE b.yjourrep_class is not null&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;10&#x29;,&#x5b;timestamp&#x5d;,23&#x29;&#x3d;&#x27;2017-10-25&#x27;&#xd;&#xa;GROUP BY project_code,year&#x28;bdate&#x29;,month&#x28;bdate&#x29;&#xd;&#xa;&#x29;,--&#x9884;&#x7b97;&#xd;&#xa;&#xd;&#xa;sale_act AS&#x28;&#xd;&#xa;select&#xd;&#xa;	project_code,--&#x9879;&#x76ee;&#x7f16;&#x7801;&#xd;&#xa;	year&#x28;audit_time&#x29; as year, --&#x5165;&#x8d26;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x5e74;&#xd;&#xa;	month&#x28;audit_time&#x29; as month, --&#x5165;&#x8d26;&#x7edf;&#x8ba1;&#x65f6;&#x95f4; &#x6708;&#xd;&#xa;  cast&#x28;year&#x28;audit_time&#x29; as varchar&#x28;20&#x29;&#x29;&#x2b;&#x27;&#x5b9e;&#x9645;&#x27; as subject_name, &#xd;&#xa;	sum&#x28;actul_price&#x29; as income_act --&#x5b9e;&#x9645;&#x6d88;&#x8d39;&#x989d;&#xd;&#xa;from ODS_XR_BENEFIT_ANALYST_ACT --&#x4e8b;&#x5b9e;&#x8868;-&#x5ba2;&#x623f;&#x7ecf;&#x8425;&#x5b9e;&#x9645;&#x8868;&#xd;&#xa;a&#xd;&#xa;LEFT JOIN YW_HS_DIM_YJOURREP_CLASS b&#xd;&#xa;ON a.yjourrep_class&#x3d;b.yjourrep_class&#xd;&#xa;WHERE b.yjourrep_class is not null&#xd;&#xa;and pccode_deptno_name&#x3d;&#x27;&#x5ba2;&#x623f;&#x27;&#xd;&#xa;AND pccode_name &#x3c;&#x3e; &#x27;&#x5ba2;&#x623f;&#x5176;&#x4ed6;&#x27;&#xd;&#xa;AND roomfee_type&#x3d;&#x27;rm&#x27;&#xd;&#xa;--AND roomfee_type&#x3d;&#x27;&#x27;&#xd;&#xa;----------&#xd;&#xa;----------&#xd;&#xa;--WHERE convert&#x28;varchar&#x28;10&#x29;,&#x5b;timestamp&#x5d;,23&#x29;&#x3d;&#x27;2017-10-25&#x27;&#xd;&#xa;group by project_code,&#xd;&#xa;	b.yjourrep_class,&#xd;&#xa;	year&#x28;audit_time&#x29;,&#xd;&#xa;	month&#x28;audit_time&#x29;&#xd;&#xa;&#x29;,--&#x7edf;&#x8ba1;&#x8d26;&#xd;&#xa;&#xd;&#xa;pjfj_sj as &#x28;&#xd;&#xa;SELECT&#xd;&#xa;       project_code,&#xd;&#xa;       year,&#xd;&#xa;       month,&#xd;&#xa;			 subject_name, &#xd;&#xa;			 SUM&#x28;income_act&#x29; AS income_act&#xd;&#xa;FROM sale_act&#xd;&#xa;GROUP BY &#xd;&#xa;	     project_code,&#xd;&#xa;       year,&#xd;&#xa;       month,&#xd;&#xa;			 subject_name&#xd;&#xa;&#x29;--&#x5b9e;&#x9645;&#xd;&#xa;&#xd;&#xa;SELECT &#xd;&#xa;c.project_code,&#xd;&#xa;a.year,&#xd;&#xa;a.month,&#xd;&#xa;cast&#x28;a.month as varchar&#x28;20&#x29;&#x29;&#x2b;&#x27;&#x6708;&#x27; as month_name,&#xd;&#xa;&#x27;1&#x27; AS mark_id,&#xd;&#xa;case WHEN isnull&#x28;a.sale_bud,0&#x29; &#x3d; 0 THEN NULL ELSE a.income_bud&#x2f;a.sale_bud END  as budget,--&#x9884;&#x7b97;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;case WHEN isnull&#x28;q.sale_act,0&#x29; &#x3d; 0 THEN NULL ELSE b.income_act&#x2f;q.sale_act END  as actual --&#x5b9e;&#x9645;&#x5e73;&#x5747;&#x623f;&#x4ef7;&#xd;&#xa;FROM pjfj_ys  a&#xd;&#xa;LEFT JOIN pjfj_sj  b&#xd;&#xa;ON a.project_code&#x3d;b.project_code&#xd;&#xa;AND a.year&#x3d;b.year&#xd;&#xa;AND a.month&#x3d;b.month&#xd;&#xa;LEFT JOIN room_act  q&#xd;&#xa;ON a.project_code&#x3d;q.project_code&#xd;&#xa;AND a.year&#x3d;q.year&#xd;&#xa;AND a.month&#x3d;q.month&#xd;&#xa;&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP c ON a.project_code &#x3d;c.projectcode&#xd;&#xa;where c.project_code is not null&#xd;&#xa;---&#x53ea;&#x66f4;&#x65b0;19&#x5e74;5&#x6708;&#x53ca;&#x4ee5;&#x540e;&#x7684;&#x6570;&#x636e;&#xd;&#xa;--and &#x28;&#x28;a.year&#x3d; 2019 and a.month&#x3e;&#x3d;5&#x29; or a.year&#x3e;2019&#x29;&#xd;&#xa;&#xd;&#xa;UNION ALL&#xd;&#xa;&#xd;&#xa;select &#xd;&#xa;			e.project_code,&#xd;&#xa;      a.year,&#xd;&#xa;			a.month,&#xd;&#xa;      cast&#x28;a.month as varchar&#x29;&#x2b;&#x27;&#x6708;&#x27; as month_name,&#xd;&#xa;			&#x27;2&#x27; AS mark_id,&#xd;&#xa;      cast&#x28;a.sale_bud as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.tsbu&#x29; as budget,&#xd;&#xa;			cast&#x28;q.sale_act as decimal&#x29;&#x2f;&#x28;cast&#x28;c.roomcount as decimal&#x29;&#x2a;d.tsac&#x29; as actual&#xd;&#xa;from pjfj_ys a&#xd;&#xa;left join pjfj_sj b on a.project_code&#x3d;b.project_code and a.year&#x3d;b.year and a.month&#x3d;b.month&#xd;&#xa;left join room_act q on a.project_code&#x3d;q.project_code and a.year&#x3d;q.year and a.month&#x3d;q.month&#xd;&#xa;LEFT JOIN sum_room c ON a.project_code&#x3d;c.project_code and a.year&#x3d;c.year and a.month&#x3d;c.month&#xd;&#xa;LEFT JOIN dim_sj d ON a.year&#x3d;d.year AND a.month&#x3d;d.month&#xd;&#xa;LEFT JOIN YW_HS_XR_BI_BERTH_MAP e ON a.project_code &#x3d;e.projectcode&#xd;&#xa;&#xd;&#xa;where e.project_code is not null&#xd;&#xa;---&#x53ea;&#x66f4;&#x65b0;19&#x5e74;5&#x6708;&#x53ca;&#x4ee5;&#x540e;&#x7684;&#x6570;&#x636e;&#xd;&#xa;--and &#x28;&#x28;a.year&#x3d; 2019 and a.month&#x3e;&#x3d;5&#x29; or a.year&#x3e;2019&#x29;&#xd;&#xa;</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>N</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>324</xloc>
      <yloc>429</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>YW_HS_KYJG2_XR_TEST &#x63d2;&#x5165; &#x2f; &#x66f4;&#x65b0;</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema/>
      <table>YW_HS_KYJG2_XR_TEST</table>
      <key>
        <name>project_code</name>
        <field>project_code</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>subject_code</name>
        <field>subject_code</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>year</name>
        <field>year</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>month</name>
        <field>month</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>project_code</name>
        <rename>project_code</rename>
        <update>N</update>
      </value>
      <value>
        <name>subject_code</name>
        <rename>subject_code</rename>
        <update>N</update>
      </value>
      <value>
        <name>subject_name</name>
        <rename>subject_name</rename>
        <update>Y</update>
      </value>
      <value>
        <name>year</name>
        <rename>year</rename>
        <update>N</update>
      </value>
      <value>
        <name>month</name>
        <rename>month</rename>
        <update>N</update>
      </value>
      <value>
        <name>month_bud</name>
        <rename>month_bud</rename>
        <update>Y</update>
      </value>
      <value>
        <name>month_act</name>
        <rename>month_act</rename>
        <update>Y</update>
      </value>
      <value>
        <name>period_bud</name>
        <rename>period_bud</rename>
        <update>Y</update>
      </value>
      <value>
        <name>period_act</name>
        <rename>period_act</rename>
        <update>Y</update>
      </value>
      <value>
        <name>last_period_act</name>
        <rename>last_period_act</rename>
        <update>Y</update>
      </value>
    </lookup>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>572</xloc>
      <yloc>535</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>YW_HS_OWE &#x8868;&#x8f93;&#x51fa;</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <schema/>
    <table>YW_HS_OWE</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>project_code</column_name>
          <stream_name>project_code</stream_name>
        </field>
        <field>
          <column_name>debt_company</column_name>
          <stream_name>debt_company</stream_name>
        </field>
        <field>
          <column_name>debt_class</column_name>
          <stream_name>debt_class</stream_name>
        </field>
        <field>
          <column_name>is_related</column_name>
          <stream_name>is_related</stream_name>
        </field>
        <field>
          <column_name>lease_area</column_name>
          <stream_name>lease_area</stream_name>
        </field>
        <field>
          <column_name>deposit</column_name>
          <stream_name>deposit</stream_name>
        </field>
        <field>
          <column_name>status</column_name>
          <stream_name>status</stream_name>
        </field>
        <field>
          <column_name>invperiod</column_name>
          <stream_name>invperiod</stream_name>
        </field>
        <field>
          <column_name>invdate</column_name>
          <stream_name>invdate</stream_name>
        </field>
        <field>
          <column_name>invamount</column_name>
          <stream_name>invamount</stream_name>
        </field>
        <field>
          <column_name>owedays</column_name>
          <stream_name>owedays</stream_name>
        </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>555</xloc>
      <yloc>330</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>YW_HS_PJFJ_XR_TEST &#x63d2;&#x5165; &#x2f; &#x66f4;&#x65b0;</name>
    <type>InsertUpdate</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <commit>100</commit>
    <update_bypassed>N</update_bypassed>
    <lookup>
      <schema/>
      <table>YW_HS_PJFJ_XR_TEST</table>
      <key>
        <name>project_code</name>
        <field>project_code</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>year</name>
        <field>year</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>month</name>
        <field>month</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <key>
        <name>mark_id</name>
        <field>mark_id</field>
        <condition>&#x3d;</condition>
        <name2/>
      </key>
      <value>
        <name>project_code</name>
        <rename>project_code</rename>
        <update>N</update>
      </value>
      <value>
        <name>year</name>
        <rename>year</rename>
        <update>N</update>
      </value>
      <value>
        <name>month</name>
        <rename>month</rename>
        <update>N</update>
      </value>
      <value>
        <name>month_name</name>
        <rename>month_name</rename>
        <update>Y</update>
      </value>
      <value>
        <name>mark_id</name>
        <rename>mark_id</rename>
        <update>N</update>
      </value>
      <value>
        <name>budget</name>
        <rename>budget</rename>
        <update>Y</update>
      </value>
      <value>
        <name>actual</name>
        <rename>actual</rename>
        <update>Y</update>
      </value>
    </lookup>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>565</xloc>
      <yloc>432</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x6e05;&#x9664;  YW_HS_OWE</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>DELETE FROM YW_HS_OWE&#xd;&#xa;WHERE project_code IN&#x28;SELECT project_code FROM YW_HS_XR_BI_BERTH_MAP&#x29;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>134</xloc>
      <yloc>330</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x6e05;&#x9664;  YW_HS_ROOM_MANAGEMENT </name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>DELETE FROM YW_HS_ROOM_MANAGEMENT &#xd;&#xa;WHERE project_code IN&#x28;SELECT project_code FROM YW_HS_XR_BI_BERTH_MAP&#x29;&#xd;&#xa;---&#x53ea;&#x66f4;&#x65b0;19&#x5e74;5&#x6708;&#x53ca;&#x4ee5;&#x540e;&#x7684;&#x6570;&#x636e;&#xd;&#xa;--and &#x28;&#x28;year&#x3d; 2019 and month&#x3e;&#x3d;5&#x29; or year&#x3e;2019&#x29;</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>141</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step>
    <name>&#x8868;&#x8f93;&#x51fa; YW_HS_ROOM_MANAGEMENT</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
         <partitioning>
           <method>none</method>
           <schema_name/>
           </partitioning>
    <connection>HS</connection>
    <schema/>
    <table>YW_HS_ROOM_MANAGEMENT</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
        <field>
          <column_name>project_code</column_name>
          <stream_name>project_code</stream_name>
        </field>
        <field>
          <column_name>year</column_name>
          <stream_name>year</stream_name>
        </field>
        <field>
          <column_name>month</column_name>
          <stream_name>month</stream_name>
        </field>
        <field>
          <column_name>market_class_code</column_name>
          <stream_name>market_class_code</stream_name>
        </field>
        <field>
          <column_name>market_class_name</column_name>
          <stream_name>market_class_name</stream_name>
        </field>
        <field>
          <column_name>market_detail_code</column_name>
          <stream_name>market_detail_code</stream_name>
        </field>
        <field>
          <column_name>market_detail_name</column_name>
          <stream_name>market_detail_name</stream_name>
        </field>
        <field>
          <column_name>sale_bud</column_name>
          <stream_name>sale_bud</stream_name>
        </field>
        <field>
          <column_name>income_bud</column_name>
          <stream_name>income_bud</stream_name>
        </field>
        <field>
          <column_name>sale_act</column_name>
          <stream_name>sale_act</stream_name>
        </field>
        <field>
          <column_name>income_act</column_name>
          <stream_name>income_act</stream_name>
        </field>
        <field>
          <column_name>sale_last</column_name>
          <stream_name>sale_last</stream_name>
        </field>
        <field>
          <column_name>income_last</column_name>
          <stream_name>income_last</stream_name>
        </field>
        <field>
          <column_name>timestamp</column_name>
          <stream_name>timestamp</stream_name>
        </field>
    </fields>
     <cluster_schema/>
 <remotesteps>   <input>   </input>   <output>   </output> </remotesteps>    <GUI>
      <xloc>542</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
      </GUI>
    </step>

  <step_error_handling>
  </step_error_handling>
   <slave-step-copy-partition-distribution>
</slave-step-copy-partition-distribution>
   <slave_transformation>N</slave_transformation>

</transformation>
